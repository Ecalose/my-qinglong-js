# -*- coding: utf-8 -*-
#!/usr/bin/env python3
"""
* 仅供学习交流，请在下载后的24小时内完全删除 请勿将任何内容用于商业或非法目的，否则后果自负。
* 小阅阅阅读 V1.73

* 活动入口,微信打开：
* 如果连接过期了运行一下就出来了最新的入口！
* http://18hn.a7c98k.shop/yunonline/v1/auth/2639bb95daba1d99e5338a8c2e21e2f0?codeurl=18hn.a7c98k.shop&codeuserid=2&time=1709021176
* 打开活动入口，抓包的任意接口cookies中的ysm_uid参数
* 
* 变量格式：
* 新建同名环境变量
* 变量名：xyyyd
* 变量值：
* # 3000 代表 3毛，后面两个推送参数可不填，那就必须配置全局推送！
* 账号备注#ysm_uid参数#unionId#提现金额如3000#wxpushApptoken#wxpushTopicId
* 
* 其他参数说明（脚本最下方填写参数）
* wxpusher全局参数：wxpusherAppToken、wxpusherTopicId
* 具体使用方法请看文档地址：https://wxpusher.zjiecode.com/docs/#/
* 
* 也可使用 微信机器人：wechatBussinessKey
* 
* 支持支付宝提现：账号备注#ysm_uid参数#unionId#提现金额如3000#wxpushApptoken#wxpushTopicId#支付宝姓名#支付宝账号
* 只想提现支付宝，不想填写其他参数，最少的参数就是：账号备注#ysm_uid参数#unionId####支付宝姓名#支付宝账号
*
* 增加 自定义检测文章等待时间：xyyydReadPostDelay，默认值是 15-20秒
* 增加 精简日志：xyyydReadPureLog，默认值是 true（也就是精简日志，如果需要显示完整的，请设置为 false）
* 
* 定时运行每半小时一次
* 达到标准自动提现
* 达到标准，自动提现
"""
# This file requires Python 3.x and the following dependencies:
# - base64
try:
    import base64
    exec(base64.b64decode('IiIiCiog5LuF5L6b5a2m5Lmg5Lqk5rWB77yM6K+35Zyo5LiL6L295ZCO55qEMjTlsI/ml7blhoXlrozlhajliKDpmaQg6K+35Yu/5bCG5Lu75L2V5YaF5a6555So5LqO5ZWG5Lia5oiW6Z2e5rOV55uu55qE77yM5ZCm5YiZ5ZCO5p6c6Ieq6LSf44CCCiog5bCP6ZiF6ZiF6ZiF6K+7IFYxLjczCgoqIOa0u+WKqOWFpeWPoyzlvq7kv6HmiZPlvIDvvJoKKiDlpoLmnpzov57mjqXov4fmnJ/kuobov5DooYzkuIDkuIvlsLHlh7rmnaXkuobmnIDmlrDnmoTlhaXlj6PvvIEKKiBodHRwOi8vMThobi5hN2M5OGsuc2hvcC95dW5vbmxpbmUvdjEvYXV0aC8yNjM5YmI5NWRhYmExZDk5ZTUzMzhhOGMyZTIxZTJmMD9jb2RldXJsPTE4aG4uYTdjOThrLnNob3AmY29kZXVzZXJpZD0yJnRpbWU9MTcwOTAyMTE3NgoqIOaJk+W8gOa0u+WKqOWFpeWPo++8jOaKk+WMheeahOS7u+aEj+aOpeWPo2Nvb2tpZXPkuK3nmoR5c21fdWlk5Y+C5pWwCiogCiog5Y+Y6YeP5qC85byP77yaCiog5paw5bu65ZCM5ZCN546v5aKD5Y+Y6YePCiog5Y+Y6YeP5ZCN77yaeHl5eWQKKiDlj5jph4/lgLzvvJoKKiAjIDMwMDAg5Luj6KGoIDPmr5vvvIzlkI7pnaLkuKTkuKrmjqjpgIHlj4LmlbDlj6/kuI3loavvvIzpgqPlsLHlv4XpobvphY3nva7lhajlsYDmjqjpgIHvvIEKKiDotKblj7flpIfms6gjeXNtX3VpZOWPguaVsCN1bmlvbklkI+aPkOeOsOmHkemineWmgjMwMDAjd3hwdXNoQXBwdG9rZW4jd3hwdXNoVG9waWNJZAoqIAoqIOWFtuS7luWPguaVsOivtOaYju+8iOiEmuacrOacgOS4i+aWueWhq+WGmeWPguaVsO+8iQoqIHd4cHVzaGVy5YWo5bGA5Y+C5pWw77yad3hwdXNoZXJBcHBUb2tlbuOAgXd4cHVzaGVyVG9waWNJZAoqIOWFt+S9k+S9v+eUqOaWueazleivt+eci+aWh+aho+WcsOWdgO+8mmh0dHBzOi8vd3hwdXNoZXIuemppZWNvZGUuY29tL2RvY3MvIy8KKiAKKiDkuZ/lj6/kvb/nlKgg5b6u5L+h5py65Zmo5Lq677yad2VjaGF0QnVzc2luZXNzS2V5CiogCiog5pSv5oyB5pSv5LuY5a6d5o+Q546w77ya6LSm5Y+35aSH5rOoI3lzbV91aWTlj4LmlbAjdW5pb25JZCPmj5DnjrDph5Hpop3lpoIzMDAwI3d4cHVzaEFwcHRva2VuI3d4cHVzaFRvcGljSWQj5pSv5LuY5a6d5aeT5ZCNI+aUr+S7mOWunei0puWPtwoqIOWPquaDs+aPkOeOsOaUr+S7mOWune+8jOS4jeaDs+Whq+WGmeWFtuS7luWPguaVsO+8jOacgOWwkeeahOWPguaVsOWwseaYr++8mui0puWPt+Wkh+azqCN5c21fdWlk5Y+C5pWwI3VuaW9uSWQjIyMj5pSv5LuY5a6d5aeT5ZCNI+aUr+S7mOWunei0puWPtwoqCiog5aKe5YqgIOiHquWumuS5ieajgOa1i+aWh+eroOetieW+heaXtumXtO+8mnh5eXlkUmVhZFBvc3REZWxhee+8jOm7mOiupOWAvOaYryAxNS0yMOenkgoqIOWinuWKoCDnsr7nroDml6Xlv5fvvJp4eXl5ZFJlYWRQdXJlTG9n77yM6buY6K6k5YC85pivIHRydWXvvIjkuZ/lsLHmmK/nsr7nroDml6Xlv5fvvIzlpoLmnpzpnIDopoHmmL7npLrlrozmlbTnmoTvvIzor7forr7nva7kuLogZmFsc2XvvIkKKiAKKiDlrprml7bov5DooYzmr4/ljYrlsI/ml7bkuIDmrKEKKiDovr7liLDmoIflh4boh6rliqjmj5DnjrAKKiDovr7liLDmoIflh4bvvIzoh6rliqjmj5DnjrAKIiIiCgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQppbXBvcnQgaGFzaGxpYgppbXBvcnQganNvbgppbXBvcnQgbWF0aAppbXBvcnQgb3MKaW1wb3J0IHN0cmluZwppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgcmFuZG9tCmltcG9ydCByZQpmcm9tIHVybGxpYi5wYXJzZSBpbXBvcnQgcXVvdGUsIHVybHBhcnNlLCBwYXJzZV9xcwppbXBvcnQgdXJsbGliMwpmcm9tIHVybGxpYi5wYXJzZSBpbXBvcnQgcGFyc2VfcXMsIHVybHNwbGl0Cgp1cmxsaWIzLmRpc2FibGVfd2FybmluZ3MoKQoKIyDloat3eHB1c2hlcueahGFwcFRva2Vu77yM6YWN572u5Zyo546v5aKD5Y+Y6YeP6YeM6L+Z5qC35rKh6YWN572u55qE6LSm5Y+35Lya6Ieq5Yqo5L2/55So6L+Z5Liq5o6o6YCBCnd4cHVzaGVyQXBwVG9rZW4gPSBvcy5nZXRlbnYoInd4cHVzaGVyQXBwVG9rZW4iKSBvciAiIgp3eHB1c2hlclRvcGljSWQgPSBvcy5nZXRlbnYoInd4cHVzaGVyVG9waWNJZCIpIG9yICIiCndlY2hhdEJ1c3NpbmVzc0tleSA9IG9zLmdldGVudigid2VjaGF0QnVzc2luZXNzS2V5Iikgb3IgIiIKcmVhZFBvc3REZWxheSA9IDAKaWYgb3MuZ2V0ZW52KCJ4eXl5ZFJlYWRQb3N0RGVsYXkiKSBhbmQgb3MuZ2V0ZW52KCJ4eXl5ZFJlYWRQb3N0RGVsYXkiKS5pc2RlY2ltYWwoKToKICAgIHJlYWRQb3N0RGVsYXkgPSBpbnQob3MuZ2V0ZW52KCJ4eXl5ZFJlYWRQb3N0RGVsYXkiKSkKcmVhZFRpbWVSYW5nZVN0ciA9IG9zLmdldGVudigieHl5eWRSZWFkVGltZVJhbmdlIikgb3IgIlswLDIzXSIKaWYgcmVhZFRpbWVSYW5nZVN0cjoKICAgIHJlYWRUaW1lUmFuZ2UgPSBqc29uLmxvYWRzKHJlYWRUaW1lUmFuZ2VTdHIpCnh5eXlkUmVhZFB1cmVMb2cgPSBUcnVlCmlmIG9zLmdldGVudigieHl5eWRSZWFkUHVyZUxvZyIpOgogICAgeHl5eWRSZWFkUHVyZUxvZyA9IG9zLmdldGVudigieHl5eWRSZWFkUHVyZUxvZyIpID09ICJ0cnVlIgoKCmRlZiBleHRyYWN0X21pZGRsZV90ZXh0KHNvdXJjZSwgYmVmb3JlX3RleHQsIGFmdGVyX3RleHQsIGFsbF9tYXRjaGVzPUZhbHNlKToKICAgIHJlc3VsdHMgPSBbXQogICAgc3RhcnRfaW5kZXggPSBzb3VyY2UuZmluZChiZWZvcmVfdGV4dCkKCiAgICB3aGlsZSBzdGFydF9pbmRleCAhPSAtMToKICAgICAgICBzb3VyY2VfYWZ0ZXJfYmVmb3JlX3RleHQgPSBzb3VyY2Vbc3RhcnRfaW5kZXggKyBsZW4oYmVmb3JlX3RleHQpIDpdCiAgICAgICAgZW5kX2luZGV4ID0gc291cmNlX2FmdGVyX2JlZm9yZV90ZXh0LmZpbmQoYWZ0ZXJfdGV4dCkKCiAgICAgICAgaWYgZW5kX2luZGV4ID09IC0xOgogICAgICAgICAgICBicmVhawoKICAgICAgICByZXN1bHRzLmFwcGVuZChzb3VyY2VfYWZ0ZXJfYmVmb3JlX3RleHRbOmVuZF9pbmRleF0pCiAgICAgICAgaWYgbm90IGFsbF9tYXRjaGVzOgogICAgICAgICAgICBicmVhawoKICAgICAgICBzb3VyY2UgPSBzb3VyY2VfYWZ0ZXJfYmVmb3JlX3RleHRbZW5kX2luZGV4ICsgbGVuKGFmdGVyX3RleHQpIDpdCiAgICAgICAgc3RhcnRfaW5kZXggPSBzb3VyY2UuZmluZChiZWZvcmVfdGV4dCkKCiAgICByZXR1cm4gcmVzdWx0cyBpZiBhbGxfbWF0Y2hlcyBlbHNlIHJlc3VsdHNbMF0gaWYgcmVzdWx0cyBlbHNlICIiCgoKZGVmIHNhZmVfcmVxdWVzdChtZXRob2QsIHVybCwgcmV0cmllcz0zLCAqKmt3YXJncyk6CiAgICBmb3IgaSBpbiByYW5nZShyZXRyaWVzKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGlmIG1ldGhvZC51cHBlcigpID09ICJHRVQiOgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCAqKmt3YXJncykKICAgICAgICAgICAgZWxpZiBtZXRob2QudXBwZXIoKSA9PSAiUE9TVCI6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCAqKmt3YXJncykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KGYi5LiN5pSv5oyB55qE6K+35rGC57G75Z6LOiB7bWV0aG9kfSIpCiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UKICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYi6K+35rGC5aSx6LSlOiB7ZX0iKQogICAgICAgICAgICBpZiBpIDwgcmV0cmllcyAtIDE6ICAjIOWmguaenOS4jeaYr+acgOWQjuS4gOasoeWwneivle+8jOWwseetieW+heS4gOauteaXtumXtOWGjemHjeivlQogICAgICAgICAgICAgICAgd2FpdCA9IHJhbmRvbS5yYW5kaW50KDEsIDUpICAjIOmaj+acuuetieW+heaXtumXtAogICAgICAgICAgICAgICAgcHJpbnQoZiLnrYnlvoUge3dhaXR9IOenkuWQjumHjeivlS4uLiIpCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKHdhaXQpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCgi5bCd6K+V6K+35rGC5aSx6LSl77yM5bey6L6+5Yiw5pyA5aSn5bCd6K+V5qyh5pWwIikKICAgICAgICAgICAgICAgIHJldHVybiBOb25lICAjIOaIluiAheS9oOWPr+S7pei/lOWbnuS4gOS4queJueWumueahOWAvOaIluWvueixoeadpeihqOekuuivt+axguWksei0pQoKCmRlZiBwdXNoKGFwcFRva2VuLCB0b3BpY0lkcywgdGl0bGUsIGxpbmssIHRleHQpOgogICAgZGF0YXB1c3QgPSB7CiAgICAgICAgImFwcFRva2VuIjogYXBwVG9rZW4sCiAgICAgICAgImNvbnRlbnQiOiBmIiIiPGJvZHkgb25sb2FkPSJ3aW5kb3cubG9jYXRpb24uaHJlZj0ne2xpbmt9JyI+5Ye6546w5qOA5rWL5paH56ug77yB77yB77yBXG48YSBzdHlsZT0ncGFkZGluZzoxMHB4O2NvbG9yOnJlZDtmb250LXNpemU6MjBweDsnIGhyZWY9J3tsaW5rfSc+54K55Ye75oiR5omT5byA5b6F5qOA5rWL5paH56ugPC9hPlxu6K+35bC95b+r54K55Ye76ZO+5o6l5a6M5oiQ6ZiF6K+7XG7lpIfms6jvvJp7dGV4dH08L2JvZHk+IiIiLAogICAgICAgICJzdW1tYXJ5IjogdGl0bGUgb3IgIuWwj+mYhemYhemYheivuyIsCiAgICAgICAgImNvbnRlbnRUeXBlIjogMiwKICAgICAgICAidG9waWNJZHMiOiBbdG9waWNJZHMgb3IgIjExNjg2Il0sCiAgICAgICAgInVybCI6IGxpbmssCiAgICB9CiAgICAjIHByaW50KGRhdGFwdXN0KQogICAgdXJscHVzdCA9ICJodHRwOi8vd3hwdXNoZXIuemppZWNvZGUuY29tL2FwaS9zZW5kL21lc3NhZ2UiCiAgICB0cnk6CiAgICAgICAgcCA9IHNhZmVfcmVxdWVzdCgiUE9TVCIsIHVybD11cmxwdXN0LCBqc29uPWRhdGFwdXN0LCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgIyBwcmludChwKQogICAgICAgIGlmIHAuanNvbigpWyJjb2RlIl0gPT0gMTAwMDoKICAgICAgICAgICAgcHJpbnQoIuKchSDmjqjpgIHmlofnq6DliLDlvq7kv6HmiJDlip/vvIzor7flsL3lv6vliY3lvoDngrnlh7vmlofnq6DvvIzkuI3nhLblsLHpu5Hlj7fllabvvIEiKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCLinYwg5o6o6YCB5paH56ug5Yiw5b6u5L+h5aSx6LSl77yM5a6M54qK5a2Q77yM6KaB6buR5Y+35LqG77yBIikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIuKdjCDmjqjpgIHmlofnq6DliLDlvq7kv6HlpLHotKXvvIzlrozniorlrZDvvIzopoHpu5Hlj7fkuobvvIEiKQogICAgICAgIHJhaXNlIGUKICAgICAgICByZXR1cm4gRmFsc2UKCgpkZWYgcHVzaFdlY2hhdEJ1c3NpbmVzcyhyb2JvdEtleSwgbGluayk6CiAgICBkYXRhcHVzdCA9IHsibXNndHlwZSI6ICJ0ZXh0IiwgInRleHQiOiB7ImNvbnRlbnQiOiBsaW5rfX0KICAgICMgcHJpbnQoZGF0YXB1c3QpCiAgICB1cmxwdXN0ID0gImh0dHBzOi8vcXlhcGkud2VpeGluLnFxLmNvbS9jZ2ktYmluL3dlYmhvb2svc2VuZD9rZXk9IiArIHJvYm90S2V5CiAgICB0cnk6CiAgICAgICAgcCA9IHNhZmVfcmVxdWVzdCgiUE9TVCIsIHVybD11cmxwdXN0LCBqc29uPWRhdGFwdXN0LCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgIyBwcmludChwKQogICAgICAgIGlmIHAuanNvbigpWyJlcnJjb2RlIl0gPT0gMDoKICAgICAgICAgICAgcHJpbnQoIuKchSDmjqjpgIHmlofnq6DliLDkvIHkuJrlvq7kv6HmiJDlip/vvIEiKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCLinYwg5o6o6YCB5paH56ug5Yiw5LyB5Lia5b6u5L+h5aSx6LSl77yBIikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBleGNlcHQ6CiAgICAgICAgcHJpbnQoIuKdjCDmjqjpgIHmlofnq6DliLDkvIHkuJrlvq7kv6HlpLHotKXvvIEiKQogICAgICAgIHJldHVybiBGYWxzZQoKCmRlZiBnZXRQb3N0V2VjaGF0SW5mbyhsaW5rKToKICAgIHRyeToKICAgICAgICByID0gc2FmZV9yZXF1ZXN0KCJHRVQiLCBsaW5rLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgIyBwcmludChsaW5rLCByLnRleHQpCiAgICAgICAgaHRtbCA9IHJlLnN1YigiXHMiLCAiIiwgci50ZXh0KQogICAgICAgIGJpeiA9IHJlLmZpbmRhbGwoJ3ZhcmJpej0iKC4qPykiXHxcfCcsIGh0bWwpCiAgICAgICAgaWYgYml6ICE9IFtdOgogICAgICAgICAgICBiaXogPSBiaXpbMF0KICAgICAgICBpZiBiaXogPT0gIiIgb3IgYml6ID09IFtdOgogICAgICAgICAgICBpZiAiX19iaXoiIGluIGxpbms6CiAgICAgICAgICAgICAgICBiaXogPSByZS5maW5kYWxsKCJfX2Jpej0oLio/KSYiLCBsaW5rKQogICAgICAgICAgICAgICAgaWYgYml6ICE9IFtdOgogICAgICAgICAgICAgICAgICAgIGJpeiA9IGJpelswXQogICAgICAgIG5pY2tuYW1lID0gcmUuZmluZGFsbCgndmFybmlja25hbWU9aHRtbERlY29kZVwoIiguKj8pIlwpOycsIGh0bWwpCiAgICAgICAgaWYgbmlja25hbWUgIT0gW106CiAgICAgICAgICAgIG5pY2tuYW1lID0gbmlja25hbWVbMF0KICAgICAgICB1c2VyX25hbWUgPSByZS5maW5kYWxsKCd2YXJ1c2VyX25hbWU9IiguKj8pIjsnLCBodG1sKQogICAgICAgIGlmIHVzZXJfbmFtZSAhPSBbXToKICAgICAgICAgICAgdXNlcl9uYW1lID0gdXNlcl9uYW1lWzBdCiAgICAgICAgbXNnX3RpdGxlID0gcmUuZmluZGFsbCgidmFybXNnX3RpdGxlPScoLio/KSdcLmh0bWxcKCIsIGh0bWwpCiAgICAgICAgaWYgbXNnX3RpdGxlICE9IFtdOgogICAgICAgICAgICBtc2dfdGl0bGUgPSBtc2dfdGl0bGVbMF0KICAgICAgICB0ZXh0ID0gZiLlhazkvJflj7fllK/kuIDmoIfor4bvvJp7Yml6fXzmlofnq6A6e21zZ190aXRsZX185L2c6ICFOntuaWNrbmFtZX186LSm5Y+3Ont1c2VyX25hbWV9IgogICAgICAgIHByaW50KHRleHQpCiAgICAgICAgcmV0dXJuIG5pY2tuYW1lLCB1c2VyX25hbWUsIG1zZ190aXRsZSwgdGV4dCwgYml6CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgIyBwcmludChlKQogICAgICAgIHByaW50KCLinYwg5o+Q5Y+W5paH56ug5L+h5oGv5aSx6LSlIikKICAgICAgICByZXR1cm4gRmFsc2UKCgpkZWYgdHMoKToKICAgIHJldHVybiBzdHIoaW50KHRpbWUudGltZSgpKSkgKyAiMDAwIgoKCmNoZWNrRGljdCA9IHsKICAgICJNemt4TlRFM016UTRNUT09IjogWyLpppnlp5DniLHml4XooYwiLCAiZ2hfNTRhNjVkYzYwMDM5Il0sCiAgICAiTXpnNU1qTTBNREV3Tnc9PSI6IFsi5oiR5pys6Z2e5YehIiwgImdoXzQ2YjA3NjkwMzQ3MyJdLAogICAgIk16VXpPRFk0TnpFMk9RPT0iOiBbIuWkmuiCieiRoeiQhDIwMjAiLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXpreU1qRTNNell4TWc9PSI6IFsiWW91aGZ1bCIsICJnaF9iM2Q3OWNkMWUxYjUiXSwKICAgICJNemt4TmpNd05ESXpPQT09IjogWyLlsJHlubTmsqHmnInkuYzmiZjpgqYzIiwgImdoX2IzZDc5Y2QxZTFiNSJdLAogICAgIk16ZzNOelV4TWpjNU1nPT0iOiBbIuaYn+aYn+ivuuiogCIsICJnaF9iM2Q3OWNkMWUxYjUiXSwKICAgICJNemc0TlRjd09ERTFOQT09IjogWyLmlpHpqazov5jmsqHnnaExMjMiLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXprME9ESXhPREU0T1E9PSI6IFsi5oyB5a625aaZ5oub5a6d5YW4IiwgImdoX2IzZDc5Y2QxZTFiNSJdLAogICAgIk16ZzJOalV5TWpJMU5BPT0iOiBbIkxpbGlubmciLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXpJek1EY3pPRGc0TXc9PSI6IFsi5pyJ5pWF5LqL55qE5ZCM5a2mWSIsICJnaF9iM2Q3OWNkMWUxYjUiXSwKICAgICJNemc1T0RVeU16WXpNUT09IjogWyI3ODnkuZ/kuI3ooYwiLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXpVME56STVNamM0T1E9PSI6IFsi55qu6JuL55im6IKJ54yqIiwgImdoXzU4ZDdlZTU5M2I4NiJdLAogICAgIk16ZzVNRGd4T0RBek1nPT0iOiBbIuWMl+WMl+Wwj+WKqeaJiyIsICJnaF81OGQ3ZWU1OTNiODYiXSwKICAgICJNekl6TURjek9EZzRNdz09IjogWyLmnInmlYXkuovnmoTlkIzlraZZIiwgImdoX2I4YjkyOTM0ZGE1ZiJdLAogICAgIk16a3hORFUxTkRFek53PT0iOiBbIuWwj+mYhemYheacjeWKoSIsICJnaF9lNTBjZmVmZWY5ZTUiXSwKICAgICJNemt4TkRZek9URXlNdz09IjogWyLok53ojpPlj6/kuZAiLCAiZ2hfNzNjYTIzOGFkZDk3Il0sCn0KCgpjbGFzcyBISFlEOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNnKToKICAgICAgICBzZWxmLmJhbGFuY2UgPSAwCiAgICAgICAgc2VsZi51bmlvbklkID0gY2dbInVuaW9uSWQiXQogICAgICAgIHNlbGYueXNtX3VpZCA9IGNnWyJ5c21fdWlkIl0KICAgICAgICAjIHByaW50KCJjZyIsIGNnLCBzZWxmLnVuaW9uSWQsIHNlbGYueXNtX3VpZCkKICAgICAgICBzZWxmLnR4YnogPSBjZ1sidHhieiJdCiAgICAgICAgc2VsZi50b3BpY0lkcyA9IGNnWyJ0b3BpY0lkcyJdCiAgICAgICAgc2VsZi5hcHBUb2tlbiA9IGNnWyJhcHBUb2tlbiJdCiAgICAgICAgZ2xvYmFsIHdlY2hhdEJ1c3NpbmVzc0tleQogICAgICAgIHNlbGYud2VjaGF0QnVzc2luZXNzS2V5ID0gd2VjaGF0QnVzc2luZXNzS2V5IG9yICIiCiAgICAgICAgc2VsZi5hbGlBY2NvdW50ID0gY2dbImFsaUFjY291bnQiXSBvciAiIgogICAgICAgIHNlbGYuYWxpTmFtZSA9IGNnWyJhbGlOYW1lIl0gb3IgIiIKICAgICAgICBzZWxmLm5hbWUgPSBjZ1sibmFtZSJdCiAgICAgICAgc2VsZi5kb21uYWluSG9zdCA9ICIxNjk4ODU1MTM5Lmh4aW9uZy50b3AiCiAgICAgICAgc2VsZi5leGNoYW5nZVBhcmFtcyA9ICIiCiAgICAgICAgc2VsZi5oZWFkZXJzID0gewogICAgICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQsICovKjsgcT0wLjAxIiwKICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA2MjEpIFhXRUIvODM1MSBGbHVlIiwKICAgICAgICAgICAgIlgtUmVxdWVzdGVkLVdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiLAogICAgICAgICAgICAiUmVmZXJlciI6IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fS8iLAogICAgICAgICAgICAiT3JpZ2luIjogZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9IiwKICAgICAgICAgICAgIyAiSG9zdCI6IGYie3NlbGYuZG9tbmFpbkhvc3R9IiwKICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ6aC1DTix6aCIsCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKICAgICAgICAgICAgIkNvb2tpZSI6IGYieXNtX3VpZD17c2VsZi55c21fdWlkfTsiLAogICAgICAgIH0KICAgICAgICBzZWxmLnJlYWRKdW1wUGF0aCA9ICIiCgogICAgZGVmIHVzZXJfaW5mbyhzZWxmKToKICAgICAgICB1ID0gZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9L3l1bm9ubGluZS92MS9zaWduX2luZm8/dGltZT17dHMoKX0mdW5pb25pZD17c2VsZi51bmlvbklkfSIKICAgICAgICByID0gIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSBzYWZlX3JlcXVlc3QoIkdFVCIsIHUpCiAgICAgICAgICAgIHJqID0gci5qc29uKCkKICAgICAgICAgICAgaWYgcmouZ2V0KCJlcnJjb2RlIikgPT0gMDoKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeiOt+WPluS/oeaBr+aIkOWKn++8jOW9k+WJjemYheivu+aWh+eroOavj+evh+WlluWKsSB7ci5qc29uKClbJ2RhdGEnXVsnYXdhcmQnXX3kuKrph5HluIEiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d6I635Y+W55So5oi35L+h5oGv5aSx6LSl77yM6LSm5Y+35byC5bi4IOaIluiAhSB5c21fdWlk5peg5pWI77yM6K+35qOA5rWLeXNtX3VpZOaYr+WQpuato+ehriIpCiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KHIudGV4dCkKICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d6I635Y+W55So5oi35L+h5oGv5aSx6LSlLHlzbV91aWTml6DmlYjvvIzor7fmo4DmtYt5c21fdWlk5piv5ZCm5q2j56GuIikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIGhhc1dlY2hhdChzZWxmKToKICAgICAgICByID0gIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHUgPSBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0veXVub25saW5lL3YxL2hhc1dlY2hhdD91bmlvbmlkPXtzZWxmLnVuaW9uSWR9IgogICAgICAgICAgICByID0gc2FmZV9yZXF1ZXN0KCJHRVQiLCB1KQogICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV3liKTmlq3lhazkvJflj7fku7vliqHmlbDph4/vvJp7ci5qc29uKClbJ2RhdGEnXVsnaGFzJ119IikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeWIpOaWreaYr+WQpuacieWFrOS8l+WPt+S7u+WKoeWksei0pe+8mntyLnRleHR9IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIGdvbGQoc2VsZik6CiAgICAgICAgciA9ICIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICB1ID0gZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9L3l1bm9ubGluZS92MS9nb2xkP3VuaW9uaWQ9e3NlbGYudW5pb25JZH0mdGltZT17dHMoKX0iCiAgICAgICAgICAgIHIgPSBzYWZlX3JlcXVlc3QoIkdFVCIsIHUpCiAgICAgICAgICAgICMgcHJpbnQoci5qc29uKCkpCiAgICAgICAgICAgIHJqID0gci5qc29uKCkKICAgICAgICAgICAgc2VsZi5yZW1haW4gPSBtYXRoLmZsb29yKGludChyai5nZXQoImRhdGEiKS5nZXQoImxhc3RfZ29sZCIpKSkKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmJ+i0puWPt1t7c2VsZi5uYW1lfV3ku4rml6Xlt7Lnu4/pmIXor7vkuoZ7cmouZ2V0KCJkYXRhIikuZ2V0KCJkYXlfcmVhZCIpfeevh+aWh+eroCzliankvZl7cmouZ2V0KCJkYXRhIikuZ2V0KCJyZW1haW5fcmVhZCIpfeacqumYheivu++8jOS7iuaXpeiOt+WPlumHkeW4gXtyai5nZXQoImRhdGEiKS5nZXQoImRheV9nb2xkIil977yM5Ymp5L2Ze3NlbGYucmVtYWlufScKICAgICAgICAgICAgKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d6I635Y+W6YeR5biB5aSx6LSl77yaIiwgZSkKICAgICAgICAgICAgIyByYWlzZSBlCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBnZXRLZXkoc2VsZik6CiAgICAgICAgdWsgPSAiIgogICAgICAgIHVrUmVzID0gTm9uZQogICAgICAgIHUgPSBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0veXVub25saW5lL3YxL3tzZWxmLnJlYWRKdW1wUGF0aH0iCiAgICAgICAgIyBwcmludCgi5o+Q56S6IGdldEtlee+8miIsIHUpCiAgICAgICAgcCA9IGYidW5pb25pZD17c2VsZi51bmlvbklkfSIKICAgICAgICByID0gc2FmZV9yZXF1ZXN0KCJQT1NUIiwgdSwgaGVhZGVycz1zZWxmLmhlYWRlcnMsIGRhdGE9cCwgdmVyaWZ5PUZhbHNlKQogICAgICAgICMgcHJpbnQoImdldEtlee+8miIsIHIudGV4dCkKICAgICAgICByaiA9IHIuanNvbigpCiAgICAgICAgZG9tYWluID0gcmouZ2V0KCJkYXRhIikuZ2V0KCJkb21haW4iKQogICAgICAgICMgcHJpbnQoIuivt+axguS4rei9rOmhte+8miIsIHIudGV4dCkKICAgICAgICBwcCA9IHBhcnNlX3FzKHVybHBhcnNlKGRvbWFpbikucXVlcnkpCiAgICAgICAgaG4gPSB1cmxwYXJzZShkb21haW4pLm5ldGxvYwogICAgICAgIHVrID0gcHAuZ2V0KCJ1ayIpWzBdCiAgICAgICAgdWtSZXMgPSByLnRleHQKICAgICAgICBpZiB1ayA9PSAiIjoKICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d6I635Y+WdWvlpLHotKXvvIzov5Tlm57plJnor6/vvJp7dWtSZXN9IikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgdGltZS5zbGVlcCg4KQogICAgICAgIHIgPSBzYWZlX3JlcXVlc3QoCiAgICAgICAgICAgICJHRVQiLAogICAgICAgICAgICBkb21haW4sCiAgICAgICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLAogICAgICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlLCBiciIsCiAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoO3E9MC45IiwKICAgICAgICAgICAgICAgICJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogICAgICAgICAgICAgICAgIkhvc3QiOiBmIntobn0iLAogICAgICAgICAgICAgICAgIlNlYy1GZXRjaC1EZXN0IjogImRvY3VtZW50IiwKICAgICAgICAgICAgICAgICJTZWMtRmV0Y2gtTW9kZSI6ICJuYXZpZ2F0ZSIsCiAgICAgICAgICAgICAgICAiU2VjLUZldGNoLVNpdGUiOiAibm9uZSIsCiAgICAgICAgICAgICAgICAiU2VjLUZldGNoLVVzZXIiOiAiPzEiLAogICAgICAgICAgICAgICAgIlVwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHMiOiAiMSIsCiAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTA3LjAuMC4wIFNhZmFyaS81MzcuMzYgTmV0VHlwZS9XSUZJIE1pY3JvTWVzc2VuZ2VyLzcuMC4yMC4xNzgxKDB4NjcwMDE0M0IpIFdpbmRvd3NXZWNoYXQoMHg2MzA5MDcxZCkgWFdFQi84NDYxIEZsdWUiLAogICAgICAgICAgICB9LAogICAgICAgICAgICB2ZXJpZnk9RmFsc2UsCiAgICAgICAgKQogICAgICAgICMgPHNjcmlwdCBzcmM9Imh0dHBzOi8vaW1hZ2UuaHp5c215eS5jbi95dW5zYW9tYS9qcy9hcnRpY2xlLmpzP3Y0LjAiPjwvc2NyaXB0PgogICAgICAgIHJlYWRKc1ZlcnNpb24gPSBleHRyYWN0X21pZGRsZV90ZXh0KHIudGV4dCwgImpzL2FydGljbGUuanM/IiwgJyInKQogICAgICAgIGlmIHJlYWRKc1ZlcnNpb24gIT0gInY0LjAiOgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDmo4DmtYvliLDmjqXlj6PniYjmnKzlj5HnlJ/lj5jljJbvvIzlvZPliY3mjqXlj6PniYjmnKzkuLrvvJp7cmVhZEpzVmVyc2lvbn3vvIzmi4nlk43orabmiqXvvIzlj7DlrZDmkJ7kuovvvIzopoHmipPkurrkuobvvIzlvIDlp4vmkqTpgIDvvIzpgIDlh7rnqIvluo8gPj4gIgogICAgICAgICAgICApCiAgICAgICAgICAgIHN5cy5leGl0KDApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+75YeG5aSH5a6M5oiQ77yae3Vrfe+8jOaPkOWPluWIsOeahOWcsOWdgO+8mntkb21haW59IikKICAgICAgICAgICAgaWYgeHl5eWRSZWFkUHVyZUxvZyA9PSBGYWxzZToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDpmIXor7vlh4blpIfmiJDlip/vvIzlvZPliY3mjqXlj6PniYjmnKzkuLrvvJp7cmVhZEpzVmVyc2lvbn0g5Y2z5bCG5byA5aeL6ZiF6K+7IOKchSDvvIzpmIXor7vlj4LmlbDkuLrvvJp7dWt9IgogICAgICAgICAgICAgICAgKQogICAgICAgIGggPSB7CiAgICAgICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMSIsCiAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSwgYnIiLAogICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoO3E9MC45IiwKICAgICAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgICAgICJIb3N0IjogIm5zci56c2YyMDIzZTQ1OC5jbG91ZCIsCiAgICAgICAgICAgICJPcmlnaW4iOiBmImh0dHBzOi8ve2hufSIsCiAgICAgICAgICAgICJTZWMtRmV0Y2gtRGVzdCI6ICJlbXB0eSIsCiAgICAgICAgICAgICJTZWMtRmV0Y2gtTW9kZSI6ICJjb3JzIiwKICAgICAgICAgICAgIlNlYy1GZXRjaC1TaXRlIjogImNyb3NzLXNpdGUiLAogICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTA3LjAuMC4wIFNhZmFyaS81MzcuMzYgTmV0VHlwZS9XSUZJIE1pY3JvTWVzc2VuZ2VyLzcuMC4yMC4xNzgxKDB4NjcwMDE0M0IpIFdpbmRvd3NXZWNoYXQoMHg2MzA5MDcxZCkgWFdFQi84NDYxIEZsdWUiLAogICAgICAgIH0KICAgICAgICByZXR1cm4gdWssIGgKCiAgICBkZWYgcmVhZChzZWxmKToKICAgICAgICBpbmZvID0gc2VsZi5nZXRLZXkoKQogICAgICAgIGlmIGxlbihpbmZvKSA9PSAwOgogICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV3ojrflj5bpmIXor7vlj4LmlbDlpLHotKXvvIzlgZzmraLlvoDlkI7pmIXor7vvvIHimqDvuI8gIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgIyBwcmludChpbmZvKQogICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICBhcmN0aWxlVGltZSA9IDEKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICByZXMgPSB7ImVycmNvZGUiOiAtMX0KICAgICAgICAgICAgcmVmcmVzaFRpbWUgPSAwCiAgICAgICAgICAgIHdoaWxlIHJlc1siZXJyY29kZSJdICE9IDA6CiAgICAgICAgICAgICAgICB0aW1lU3RhbXAgPSBzdHIodHMoKSkKICAgICAgICAgICAgICAgIHBzZ24gPSBoYXNobGliLm1kNSgKICAgICAgICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9bMV1bIk9yaWdpbiJdLnJlcGxhY2UoImh0dHBzOi8vIiwgIiIpWzA6MTFdCiAgICAgICAgICAgICAgICAgICAgICAgICsgaW5mb1swXQogICAgICAgICAgICAgICAgICAgICAgICArIHRpbWVTdGFtcAogICAgICAgICAgICAgICAgICAgICAgICArICJBJkkyNUxJTElZRFMkIgogICAgICAgICAgICAgICAgICAgICkuZW5jb2RlKCkKICAgICAgICAgICAgICAgICkuaGV4ZGlnZXN0KCkKICAgICAgICAgICAgICAgICMgcHJpbnQoaW5mbywgdGltZVN0YW1wKQogICAgICAgICAgICAgICAgc2VsZi5wYXJhbXMgPSB7CiAgICAgICAgICAgICAgICAgICAgInVrIjogaW5mb1swXSwKICAgICAgICAgICAgICAgICAgICAidGltZSI6IHRpbWVTdGFtcCwKICAgICAgICAgICAgICAgICAgICAicHNnbiI6IHBzZ24sCiAgICAgICAgICAgICAgICAgICAgInYiOiAiNC4wIiwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHUgPSBmImh0dHBzOi8vbnNyLnpzZjIwMjNlNDU4LmNsb3VkL3l1bm9ubGluZS92MS9kb19yZWFkIgogICAgICAgICAgICAgICAgciA9IHNhZmVfcmVxdWVzdCgKICAgICAgICAgICAgICAgICAgICAiR0VUIiwKICAgICAgICAgICAgICAgICAgICB1LAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9aW5mb1sxXSwKICAgICAgICAgICAgICAgICAgICBwYXJhbXM9c2VsZi5wYXJhbXMsCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ9NjAsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBwcmludCgiLSIgKiA1MCkKICAgICAgICAgICAgICAgICMgcHJpbnQoCiAgICAgICAgICAgICAgICAjICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV3nrKxbe3JlZnJlc2hUaW1lKzF9XeasoeiOt+WPlumYheivu+aWh+eroFt7aW5mb1swXX1d55uu55qE6aG177yae3IudGV4dH0iCiAgICAgICAgICAgICAgICAjICkKICAgICAgICAgICAgICAgICMgcHJpbnQoIumYheivu+aWh+eroOWPguaVsOafpeeci++8miIsIHUsIHNlbGYucGFyYW1zLCByLnRleHQsIGluZm9bMV0pCiAgICAgICAgICAgICAgICBpZiByLnRleHQgYW5kIHIuanNvbigpWyJlcnJjb2RlIl0gPT0gMDoKICAgICAgICAgICAgICAgICAgICByZXMgPSByLmpzb24oKQogICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV3nrKxbe3JlZnJlc2hUaW1lKzF9XeasoeiOt+WPluesrFt7YXJjdGlsZVRpbWV9Xeevh+mYheivu+aWh+eroFt7aW5mb1swXX1d6Lez6L2s6ZO+5o6l5oiQ5YqfIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgZGVjb2RlZF9zdHIgPSBqc29uLmxvYWRzKHIudGV4dCkKICAgICAgICAgICAgICAgICAgICBpZiBkZWNvZGVkX3N0clsibXNnIl06CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiLotKblj7dbe3NlbGYubmFtZX1d56ysW3tyZWZyZXNoVGltZSsxfV3mrKHojrflj5bnrKxbe2FyY3RpbGVUaW1lfV3nr4fpmIXor7vmlofnq6Bbe2luZm9bMF19Xei3s+i9rOmTvuaOpeWksei0pe+8mntkZWNvZGVkX3N0clsnbXNnJ119IgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiLotKblj7dbe3NlbGYubmFtZX1d56ysW3tyZWZyZXNoVGltZSsxfV3mrKHojrflj5bnrKxbe2FyY3RpbGVUaW1lfV3nr4fpmIXor7vmlofnq6Bbe2luZm9bMF19Xei3s+i9rOmTvuaOpeWksei0pe+8mntyLnRleHR9IgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEuNSkKICAgICAgICAgICAgICAgIHJlZnJlc2hUaW1lID0gcmVmcmVzaFRpbWUgKyAxCiAgICAgICAgICAgICAgICBpZiByZWZyZXNoVGltZSA+PSA1OgogICAgICAgICAgICAgICAgICAgIHByaW50KGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV3ojrflj5bpmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19Xei2heaXtuKApuKApiIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHdlY2hhdFBvc3RMaW5rID0gIiIKICAgICAgICAgICAgaWYgcmVzLmdldCgiZXJyY29kZSIpID09IDA6CiAgICAgICAgICAgICAgICByZXR1cm5MaW5rID0gIiIKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICByZXR1cm5MaW5rID0gcmVzLmdldCgiZGF0YSIpLmdldCgibGluayIpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV3ojrflj5bpmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XemTvuaOpeWksei0pe+8jOeWkeS8vOWPsOWtkOaOpeWPo+WkquWeg+Wcvu+8jOW0qeS6hu+8jOi/lOWbnuaVsOaNruS4uu+8miIsCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5nZXQoImRhdGEiKSwKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGlmICJtcC53ZWl4aW4ucXEuY29tIiBpbiByZXR1cm5MaW5rOgogICAgICAgICAgICAgICAgICAgIGlmIHh5eXlkUmVhZFB1cmVMb2cgPT0gRmFsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDpmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4flvq7kv6Hmlofnq6DvvJp7cmV0dXJuTGlua30iKQogICAgICAgICAgICAgICAgICAgIHdlY2hhdFBvc3RMaW5rID0gcmV0dXJuTGluawogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDpmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Dlh4blpIfot7PovazvvJp7bGlua30iKQogICAgICAgICAgICAgICAgICAgIHdlY2hhdFBvc3RMaW5rID0gc2VsZi5qdW1wKHJldHVybkxpbmspCiAgICAgICAgICAgICAgICAgICAgaWYgeHl5eWRSZWFkUHVyZUxvZyA9PSBGYWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5b6u5L+h5paH56ug77yae3dlY2hhdFBvc3RMaW5rfSIKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaWYgeHl5eWRSZWFkUHVyZUxvZyA9PSBGYWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ug77yae3dlY2hhdFBvc3RMaW5rfSIpCiAgICAgICAgICAgICAgICBzbGVlcFRpbWUgPSByYW5kb20ucmFuZGludCg3LCAxMCkKICAgICAgICAgICAgICAgIGlmICJtcC53ZWl4aW4ucXEuY29tIiBpbiB3ZWNoYXRQb3N0TGluazoKICAgICAgICAgICAgICAgICAgICBwb3N0V2VjaGF0SW5mbyA9IGdldFBvc3RXZWNoYXRJbmZvKHdlY2hhdFBvc3RMaW5rKQogICAgICAgICAgICAgICAgICAgIGlmIHBvc3RXZWNoYXRJbmZvID09IEZhbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV3lm6Ag6I635Y+W5YWs5LyX5Y+35paH56ug5L+h5oGv5LiN5oiQ5Yqf77yM5a+86Ie06ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV0g5aSx6LSl4oCm4oCmIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAgICAgICAgICMg5aaC5p6c5piv5qOA5rWL54m55b6B5Yiw55qE5paH56ugIOaIluiAhSDlkI7kuIDnr4fmlofnq6DkuI7liY3kuIDnr4fnm7jkvLwKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrRGljdC5nZXQocG9zdFdlY2hhdEluZm9bNF0pICE9IE5vbmUKICAgICAgICAgICAgICAgICAgICAgICAgb3IgKHJlcy5nZXQoImRhdGEiKS5nZXQoImEiKSA9PSAyKQogICAgICAgICAgICAgICAgICAgICAgICBvciAoIiZjaGtzbT0iIGluIHdlY2hhdFBvc3RMaW5rKQogICAgICAgICAgICAgICAgICAgICAgICBvciAoIl9fYml6IiBub3QgaW4gd2VjaGF0UG9zdExpbmspCiAgICAgICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICAgICAgc2xlZXBUaW1lID0gcmVhZFBvc3REZWxheSBvciByYW5kb20ucmFuZGludCgxNSwgMjApCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiLimqDvuI8g6LSm5Y+3W3tzZWxmLm5hbWV9XemYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1dIOajgOa1i+WIsOeWkeS8vOajgOa1i+aWh+eroO+8jOato+WcqOaOqOmAge+8jOetieW+hei/h+ajgOa1i++8jOetieW+heaXtumXtO+8mntzbGVlcFRpbWV956eS44CC44CC44CCIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNlbGYud2VjaGF0QnVzc2luZXNzS2V5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVzaFdlY2hhdEJ1c3NpbmVzcyhzZWxmLndlY2hhdEJ1c3NpbmVzc0tleSwgd2VjaGF0UG9zdExpbmspCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5hcHBUb2tlbjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1c2goCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hcHBUb2tlbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRvcGljSWRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICLlsI/pmIXpmIXpmIXor7vov4fmo4DmtYsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlY2hhdFBvc3RMaW5rLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XemYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1dIOato+WcqOetieW+hei/h+ajgOa1i++8jOetieW+heaXtumXtO+8mntzbGVlcFRpbWV956eSXG7lubvnlJ/mj5DnpLrvvJrlv6vngrnvvIzliKvogL3mkIHml7bpl7TkuobvvIEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiLimqDvuI8g6LSm5Y+3W3tzZWxmLm5hbWV9XemYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1dIOmcgOimgei/h+ajgOa1i++8jOS9huaYr+acqumFjee9ruaOqOmAgXRva2Vu77yM5Li65LqG6YG/5YWN6buR5Y+377yM5YGc5q2i6ZiF6K+744CC44CC44CCIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIuKchSDotKblj7dbe3NlbGYubmFtZX1d6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV0g6Z2e5qOA5rWL5paH56ug77yM5qih5ouf6K+7e3NsZWVwVGltZX3np5IiCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4pyFIOi0puWPt1t7c2VsZi5uYW1lfV3pmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XSDpnZ7mo4DmtYvmlofnq6DvvIzmqKHmi5/or7t7c2xlZXBUaW1lfeenkiIKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKHNsZWVwVGltZSkKICAgICAgICAgICAgICAgIHUxID0gZiJodHRwOi8vbnNyLnpzZjIwMjNlNDU4LmNsb3VkL3l1bm9ubGluZS92MS9nZXRfcmVhZF9nb2xkP3VrPXtpbmZvWzBdfSZ0aW1lPXtzbGVlcFRpbWV9JnRpbWVzdGFtcD17dHMoKX0iCiAgICAgICAgICAgICAgICByMSA9IHNhZmVfcmVxdWVzdCgiR0VUIiwgdTEsIGhlYWRlcnM9aW5mb1sxXSwgdmVyaWZ5PUZhbHNlKQogICAgICAgICAgICAgICAgaWYgcjEudGV4dCBhbmQgcjEuanNvbigpOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIuKchSDotKblj7dbe3NlbGYubmFtZX1d6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3miYDlvpfph5HluIHvvJp7cjEuanNvbigpWydkYXRhJ11bJ2dvbGQnXX3kuKrvvIzotKbmiLflvZPliY3ph5HluIHvvJp7cjEuanNvbigpWydkYXRhJ11bJ2xhc3RfZ29sZCddfeS4qu+8jOS7iuaXpeW3suivu++8mntyMS5qc29uKClbJ2RhdGEnXVsnZGF5X3JlYWQnXX3mrKHvvIzku4rml6XmnKror7sge3IxLmpzb24oKVsnZGF0YSddWydyZW1haW5fcmVhZCddfeevh+aWh+eroCIKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIuKdjCDotKblj7dbe3NlbGYubmFtZX1d6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3lvILluLjvvJp7cjEuanNvbigpLmdldCgnbXNnJyl9IgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICLmnKzmrKHpmIXor7vml6DmlYgiIGluIHIxLmpzb24oKS5nZXQoIm1zZyIpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICBmIuKdjCDotKblj7dbe3NlbGYubmFtZX1d6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3lpLHotKXvvJp7cjEudGV4dH0iCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsaWYgcmVzLmdldCgiZXJyY29kZSIpID09IDQwNToKICAgICAgICAgICAgICAgIHByaW50KGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV3pmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XemYheivu+mHjeWkjSIpCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEuNSkKICAgICAgICAgICAgZWxpZiByZXMuZ2V0KCJlcnJjb2RlIikgPT0gNDA3OgogICAgICAgICAgICAgICAgcHJpbnQoZiLimqDvuI8g6LSm5Y+3W3tzZWxmLm5hbWV9XemYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1d6ZiF6K+757uT5p2fIikKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludChmIuKaoO+4jyDotKblj7dbe3NlbGYubmFtZX1d6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3mnKrnn6Xmg4XlhrUiKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxLjUpCiAgICAgICAgICAgIGFyY3RpbGVUaW1lID0gYXJjdGlsZVRpbWUgKyAxCgogICAgZGVmIGp1bXAoc2VsZiwgbGluayk6CiAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d5byA5aeL5pys5qyh6ZiF6K+74oCm4oCmIikKICAgICAgICBobiA9IHVybHBhcnNlKGxpbmspLm5ldGxvYwogICAgICAgIGggPSB7CiAgICAgICAgICAgICJIb3N0IjogaG4sCiAgICAgICAgICAgICJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogICAgICAgICAgICAiVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0cyI6ICIxIiwKICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA2MjEpIFhXRUIvODM1MSBGbHVlIiwKICAgICAgICAgICAgIkFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLAogICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoIiwKICAgICAgICAgICAgIkNvb2tpZSI6IGYieXNtX3VpZD17c2VsZi55c21fdWlkfSIsCiAgICAgICAgfQogICAgICAgIHIgPSBzYWZlX3JlcXVlc3QoIkdFVCIsIGxpbmssIGhlYWRlcnM9aCwgYWxsb3dfcmVkaXJlY3RzPUZhbHNlLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgIyBwcmludChyLnN0YXR1c19jb2RlKQogICAgICAgIExvY2F0aW9uID0gci5oZWFkZXJzLmdldCgiTG9jYXRpb24iKQogICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeW8gOWni+mYheivu+aWh+eroCAtIHtMb2NhdGlvbn0iKQogICAgICAgIHJldHVybiBMb2NhdGlvbgoKICAgIGRlZiB3aXRoZHJhd1Bvc3Qoc2VsZiwgZXhjaGFuZ2VQYXJhbXMpOgogICAgICAgIHUgPSBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0veXVub25saW5lL3YxL3dpdGhkcmF3IgogICAgICAgIHAgPSBmInVuaW9uaWQ9e2V4Y2hhbmdlUGFyYW1zWyd1bmlvbmlkJ119JnNpZ25pZD17ZXhjaGFuZ2VQYXJhbXNbJ3JlcXVlc3RfaWQnXX0mdWE9MCZwdHlwZT0wJnBhY2NvdW50PSZwbmFtZT0iCiAgICAgICAgaWYgc2VsZi5hbGlBY2NvdW50IGFuZCBzZWxmLmFsaU5hbWU6CiAgICAgICAgICAgIHAgPSBmInVuaW9uaWQ9e2V4Y2hhbmdlUGFyYW1zWyd1bmlvbmlkJ119JnNpZ25pZD17ZXhjaGFuZ2VQYXJhbXNbJ3JlcXVlc3RfaWQnXX0mdWE9MiZwdHlwZT0xJnBhY2NvdW50PXtxdW90ZShzZWxmLmFsaUFjY291bnQpfSZwbmFtZT17cXVvdGUoc2VsZi5hbGlOYW1lKX0iCiAgICAgICAgciA9IHNhZmVfcmVxdWVzdCgKICAgICAgICAgICAgIlBPU1QiLAogICAgICAgICAgICB1LAogICAgICAgICAgICBoZWFkZXJzPXsKICAgICAgICAgICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMSIsCiAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ6aC1DTix6aDtxPTAuOSIsCiAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsCiAgICAgICAgICAgICAgICAiQ29va2llIjogZiJ5c211aWQ9e3NlbGYueXNtX3VpZH07IGVqZWN0Q29kZT0xIiwKICAgICAgICAgICAgICAgICJIb3N0IjogZiJ7c2VsZi5kb21uYWluSG9zdH0iLAogICAgICAgICAgICAgICAgIk9yaWdpbiI6IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fSIsCiAgICAgICAgICAgICAgICAiUHJveHktQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAgICAgICAgICJSZWZlcmVyIjogZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9L3l1bm9ubGluZS92MS9leGNoYW5nZT91bmlvbmlkPXtleGNoYW5nZVBhcmFtc1sndW5pb25pZCddfSZyZXF1ZXN0X2lkPXtleGNoYW5nZVBhcmFtc1sncmVxdWVzdF9pZCddfSZxcmNvZGVfbnVtYmVyPTE2NjA3ODY0MzU4MTQ1NTg4IiwKICAgICAgICAgICAgICAgICJYLVJlcXVlc3RlZC1XaXRoIjogIlhNTEh0dHBSZXF1ZXN0IiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZGF0YT1wLAogICAgICAgICAgICB2ZXJpZnk9RmFsc2UsCiAgICAgICAgKQogICAgICAgIHByaW50KGYi4pyFIOi0puWPt1t7c2VsZi5uYW1lfV0g5o+Q546w57uT5p6c77yaIiwgci5qc29uKClbIm1zZyJdKQoKICAgIGRlZiB3aXRoZHJhdyhzZWxmKToKICAgICAgICBnb2xkID0gaW50KGludChzZWxmLnJlbWFpbikgLyAxMDAwKSAqIDEwMDAKICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV0g5pys5qyh5o+Q546w6YeR6aKdICIsIHNlbGYuYmFsYW5jZSwgIuWFgyArICIsIGdvbGQsICLph5HluIEiKQogICAgICAgIHF1ZXJ5ID0gdXJsc3BsaXQoc2VsZi5leGNoYW5nZVBhcmFtcykucXVlcnkKICAgICAgICBleGNoYW5nZVBhcmFtcyA9IHBhcnNlX3FzKHF1ZXJ5KQogICAgICAgICMg5bCG5YiX6KGo5YC86L2s5o2i5Li65a2X56ym5LiyCiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gZXhjaGFuZ2VQYXJhbXMuaXRlbXMoKToKICAgICAgICAgICAgZXhjaGFuZ2VQYXJhbXNba2V5XSA9IHZhbHVlWzBdCiAgICAgICAgd2l0aGRyYXdCYWxhbmNlID0gcm91bmQoKGludChzZWxmLnR4YnopIC8gMTAwMDApLCAzKQogICAgICAgIGlmIGdvbGQgb3IgKHNlbGYuYmFsYW5jZSA+PSB3aXRoZHJhd0JhbGFuY2UpOgogICAgICAgICAgICBpZiBnb2xkOgogICAgICAgICAgICAgICAgIyDlvIDlp4vmj5DnjrAKICAgICAgICAgICAgICAgIHUxID0gZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9L3l1bm9ubGluZS92MS91c2VyX2dvbGQiCiAgICAgICAgICAgICAgICBwMSA9IGYidW5pb25pZD17ZXhjaGFuZ2VQYXJhbXNbJ3VuaW9uaWQnXX0mcmVxdWVzdF9pZD17ZXhjaGFuZ2VQYXJhbXNbJ3JlcXVlc3RfaWQnXX0mZ29sZD17Z29sZH0iCiAgICAgICAgICAgICAgICByID0gc2FmZV9yZXF1ZXN0KAogICAgICAgICAgICAgICAgICAgICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICB1MSwKICAgICAgICAgICAgICAgICAgICBkYXRhPXAxLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCwgKi8qOyBxPTAuMDEiLAogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoO3E9MC45IiwKICAgICAgICAgICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLAogICAgICAgICAgICAgICAgICAgICAgICAiQ29va2llIjogZiJ5c211aWQ9e3NlbGYueXNtX3VpZH07IGVqZWN0Q29kZT0xIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkhvc3QiOiBmIntzZWxmLmRvbW5haW5Ib3N0fSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJPcmlnaW4iOiBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0iLAogICAgICAgICAgICAgICAgICAgICAgICAiUHJveHktQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlJlZmVyZXIiOiBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0veXVub25saW5lL3YxL2V4Y2hhbmdle3NlbGYuZXhjaGFuZ2VQYXJhbXN9IiwKICAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA3MWQpIFhXRUIvODQ2MSBGbHVlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlgtUmVxdWVzdGVkLVdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHJlcyA9IHIuanNvbigpCiAgICAgICAgICAgICAgICAgICAgaWYgcmVzLmdldCgiZXJyY29kZSIpID09IDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhkcmF3QmFsYW5jZU51bSA9IHNlbGYuYmFsYW5jZSArIGZsb2F0KHJlc1siZGF0YSJdWyJtb25leSJdKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi4pyFIOi0puWPt1t7c2VsZi5uYW1lfV0g6YeR5biB5YWR5o2i5Li6546w6YeR5oiQ5Yqf77yM5byA5aeL5o+Q546w77yM6aKE6K6h5Yiw6LSmIHt3aXRoZHJhd0JhbGFuY2VOdW19IOWFgyA+Pj4gIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHdpdGhkcmF3QmFsYW5jZU51bSA8IHdpdGhkcmF3QmFsYW5jZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9Xeayoeaciei+vuWIsOaPkOeOsOagh+WHhiB7d2l0aGRyYXdCYWxhbmNlfSDlhYMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYud2l0aGRyYXdQb3N0KGV4Y2hhbmdlUGFyYW1zKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDph5HluIHlhZHmjaLkuLrnjrDph5HlpLHotKXvvJoiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgci50ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiDmj5DnjrDlnLDlnYDvvJoiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIOaPkOeOsOWPguaVsO+8miIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMSwKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICMgcmFpc2UgZQogICAgICAgICAgICAgICAgICAgICMg5aSE55CG5byC5bi4CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOaPkOeOsOWksei0pe+8miIsIGUpCiAgICAgICAgICAgIHNlbGYud2l0aGRyYXdQb3N0KGV4Y2hhbmdlUGFyYW1zKQoKICAgIGRlZiBpbml0KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgY2hhcmFjdGVycyA9IHN0cmluZy5hc2NpaV9sZXR0ZXJzICsgc3RyaW5nLmRpZ2l0cwogICAgICAgICAgICByID0gc2FmZV9yZXF1ZXN0KAogICAgICAgICAgICAgICAgIkdFVCIsCiAgICAgICAgICAgICAgICBmImh0dHBzOi8vbnNyLnpzZjIwMjNlNDU4LmNsb3VkL3l1bm9ubGluZS92MS9nZXRjaGF0c2l0ZT90PXt0aW1lLnRpbWUoKX0mY2lkPXsnJy5qb2luKHJhbmRvbS5jaG9pY2VzKGNoYXJhY3RlcnMsIGs9MzIpKX0mY29kZT0wODFrdFJGYTFUTTYwSDBncjRHYTFVeycnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz0xMCkpfSZzdGF0ZT0xIiwKICAgICAgICAgICAgICAgIHZlcmlmeT1GYWxzZSwKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLmRvbW5haW5Ib3N0ID0gci5qc29uKClbImRhdGEiXVsibHVvZGkiXS5zcGxpdCgiLyIpWzJdCiAgICAgICAgICAgICMgcHJpbnQoci50ZXh0KQogICAgICAgICAgICBpZiB4eXl5ZFJlYWRQdXJlTG9nID09IEZhbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d5o+Q5Y+W5Yiw55qE5Z+f5ZCN77yae3NlbGYuZG9tbmFpbkhvc3R9IikKICAgICAgICAgICAgc2VsZi5oZWFkZXJzID0gewogICAgICAgICAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCwgKi8qOyBxPTAuMDEiLAogICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA2MjEpIFhXRUIvODM1MSBGbHVlIiwKICAgICAgICAgICAgICAgICJYLVJlcXVlc3RlZC1XaXRoIjogIlhNTEh0dHBSZXF1ZXN0IiwKICAgICAgICAgICAgICAgICJSZWZlcmVyIjogZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9LyIsCiAgICAgICAgICAgICAgICAiT3JpZ2luIjogZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9IiwKICAgICAgICAgICAgICAgICMgIkhvc3QiOiBmIntzZWxmLmRvbW5haW5Ib3N0fSIsCiAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ6aC1DTix6aCIsCiAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsCiAgICAgICAgICAgICAgICAiQ29va2llIjogZiJ5c21fdWlkPXtzZWxmLnlzbV91aWR9OyIsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgIyDojrflj5ZyZXF1ZXN0SWQKICAgICAgICAgICAgc2VsZi5zaWduaWQgPSAiIgogICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgzKToKICAgICAgICAgICAgICAgIHIgPSBzYWZlX3JlcXVlc3QoCiAgICAgICAgICAgICAgICAgICAgIkdFVCIsCiAgICAgICAgICAgICAgICAgICAgZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9LyIsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVycz17CiAgICAgICAgICAgICAgICAgICAgICAgICJVcGdyYWRlLUluc2VjdXJlLVJlcXVlc3RzIjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTA3LjAuMC4wIFNhZmFyaS81MzcuMzYgTmV0VHlwZS9XSUZJIE1pY3JvTWVzc2VuZ2VyLzcuMC4yMC4xNzgxKDB4NjcwMDE0M0IpIFdpbmRvd3NXZWNoYXQoMHg2MzA5MDcxZCkgWFdFQi84NDYxIEZsdWUiLAogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiemgtQ04semg7cT0wLjkiLAogICAgICAgICAgICAgICAgICAgICAgICAiQ29va2llIjogZiJ5c211aWQ9e3NlbGYueXNtX3VpZH0iLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaHRtbHRleHQgPSByLnRleHQKICAgICAgICAgICAgICAgIGlmIHIuaGlzdG9yeToKICAgICAgICAgICAgICAgICAgICBmb3IgcmVzcCBpbiByLmhpc3Rvcnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICJvcGVuLndlaXhpbi5xcS5jb20iIGluIHJlc3AuaGVhZGVyc1siTG9jYXRpb24iXToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSBDb29raWXlt7Lov4fmnJ/vvIzor7fph43ov5vkuIDkuIvnvZHnq5nvvIzlsLHkvJroh6rliqjmm7TmlrBDb29raWXvvIjnm67liY3kuI3noa7lrprov4fmnJ/mmK/lm6DkuLroh6rlt7HmiYvliqjov5vljrvov4fkuobov5jmmK/ku4DkuYjlhbbku5bljp/lm6DvvIkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIHJlczEgPSByZS5zdWIoIlxzIiwgIiIsIGh0bWx0ZXh0KQogICAgICAgICAgICAgICAgc2lnbmlkbCA9IHJlLmZpbmRhbGwoJ1wpXHxcfCIoLio/KSI7JywgcmVzMSkKICAgICAgICAgICAgICAgICMgcHJpbnQoc2lnbmlkbCwgaHRtbHRleHQpCiAgICAgICAgICAgICAgICBpZiAi6K+l6LSm5Y+35a2Y5Zyo6L+d6KeE5pON5L2c77yM5bey6KKr5bCB56aBIiBpbiBodG1sdGV4dDoKICAgICAgICAgICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV0g5a2Y5Zyo6L+d6KeE5pON5L2c77yM5bey6KKr5bCB56aB77yM5YeJ5YeJ77yM6L+H5Lik5Liq5pyI5YaN55yL55yL6Kej5rKh6Kej5bCB5ZCnfiAiKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAgICAgaWYgc2lnbmlkbCA9PSBbXToKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaWduaWQgPSBzaWduaWRsWzBdCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgIyDojrflj5bmj5DnjrDpobXpnaLlnLDlnYAKICAgICAgICAgICAgciA9IHNhZmVfcmVxdWVzdCgKICAgICAgICAgICAgICAgICJHRVQiLAogICAgICAgICAgICAgICAgZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9Lz9jYXRlPTAiLAogICAgICAgICAgICAgICAgaGVhZGVycz17CiAgICAgICAgICAgICAgICAgICAgIlVwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHMiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA3MWQpIFhXRUIvODQ2MSBGbHVlIiwKICAgICAgICAgICAgICAgICAgICAiQWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoO3E9MC45IiwKICAgICAgICAgICAgICAgICAgICAiQ29va2llIjogZiJ5c211aWQ9e3NlbGYueXNtX3VpZH0iLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHZlcmlmeT1GYWxzZSwKICAgICAgICAgICAgKQogICAgICAgICAgICBodG1sdGV4dCA9IHIudGV4dAogICAgICAgICAgICByZWFkX2p1bXBfcmVhZF90ZXh0ID0gZXh0cmFjdF9taWRkbGVfdGV4dCgKICAgICAgICAgICAgICAgIGh0bWx0ZXh0LAogICAgICAgICAgICAgICAgImZ1bmN0aW9uIHJlYWRfanVtcF9yZWFkKHR5cGUsdGltZSl7IiwKICAgICAgICAgICAgICAgICJzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsiLAogICAgICAgICAgICApCiAgICAgICAgICAgIGlmIHJlYWRfanVtcF9yZWFkX3RleHQ6CiAgICAgICAgICAgICAgICByZWFkSnVtcFBhdGggPSBleHRyYWN0X21pZGRsZV90ZXh0KAogICAgICAgICAgICAgICAgICAgIHJlYWRfanVtcF9yZWFkX3RleHQsICJ1cmw6IGRvbWFpbisnIiwgIicsIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaWYgcmVhZEp1bXBQYXRoOgogICAgICAgICAgICAgICAgICAgIHNlbGYucmVhZEp1bXBQYXRoID0gcmVhZEp1bXBQYXRoCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV0g5Yid5aeL5YyW5aSx6LSl77yM6K+35omL5Yqo6K6/6Zeu5LiL56Gu6K6k6aG16Z2i5rKh5bSp5rqDIOaIluiAhSDnqI3lkI7lho3or5XlkKfvvIzkuIDnm7TkuI3ooYzvvIzor7fliY3lvoBUR+e+pOWPjemmiH4gIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmICLlrZjlnKjov53op4Tmk43kvZwiIGluIGh0bWx0ZXh0OgogICAgICAgICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDooqvmo4DmtYvliLDkuobvvIzlt7Lnu4/ooqvlsIHvvIznu4jmraLku7vliqHvvIzlv6vljrvmj5DphpLlpKflrrblkKd+ICIpCiAgICAgICAgICAgICAgICAgICAgc3lzLmV4aXQoMCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDliJ3lp4vljJblpLHotKXvvIzor7fmiYvliqjorr/pl67kuIvnoa7orqTpobXpnaLmsqHltKnmuoMg5oiW6ICFIOeojeWQjuWGjeivleWQp++8jOS4gOebtOS4jeihjO+8jOivt+WJjeW+gFRH576k5Y+N6aaIfiAiCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICByZXMxID0gcmUuc3ViKCJccyIsICIiLCBodG1sdGV4dCkKICAgICAgICAgICAgc2lnbmlkbCA9IHJlLmZpbmRhbGwoJy95dW5vbmxpbmUvdjEvZXhjaGFuZ2UoLio/KSInLCByZXMxKQogICAgICAgICAgICAjIHByaW50KCLliJ3lp4vljJYg5o+Q546w5Y+C5pWwOiIsIHNpZ25pZGxbMF0pCiAgICAgICAgICAgIGlmIHNpZ25pZGwgPT0gW106CiAgICAgICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV3liJ3lp4vljJYg5o+Q546w5Y+C5pWwIOWksei0pSzotKblj7flvILluLgiKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmV4Y2hhbmdlUGFyYW1zID0gc2lnbmlkbFswXQogICAgICAgICAgICByZXdhcmROdW1SZXN1bHQgPSByZS5zZWFyY2goCiAgICAgICAgICAgICAgICAnZGl2IGNsYXNzPSJudW0gbnVtYmVyIHJld2FyZE51bSI+KC4qPyk8LycsIGh0bWx0ZXh0CiAgICAgICAgICAgICkKICAgICAgICAgICAgIyBwcmludCgi5Yid5aeL5YyWIOaPkOeOsOWPguaVsDoiLCBzaWduaWRsWzBdKQogICAgICAgICAgICBpZiByZXdhcmROdW1SZXN1bHQgPT0gW106CiAgICAgICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV3liJ3lp4vljJYg5o+Q546w5Y+C5pWwIOWksei0pSzotKblj7flvILluLgiKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmJhbGFuY2UgPSBmbG9hdChyZXdhcmROdW1SZXN1bHRbMV0pCiAgICAgICAgICAgIGlmIHNlbGYuc2lnbmlkID09ICIiOgogICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d5Yid5aeL5YyWIHJlcXVlc3RJZCDlpLHotKUs6LSm5Y+35byC5bi4IikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgIyByYWlzZSBlCiAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeWIneWni+WMluWksei0pSzor7fmo4Dmn6XkvaDnmoRjayIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgaWYgc2VsZi5pbml0KCk6CiAgICAgICAgICAgIHNlbGYudXNlcl9pbmZvKCkKICAgICAgICAgICAgc2VsZi5oYXNXZWNoYXQoKQogICAgICAgICAgICBzZWxmLmdvbGQoKQogICAgICAgICAgICBjdXJyZW50SG91ciA9IGRhdGV0aW1lLm5vdygpLmhvdXIKICAgICAgICAgICAgaWYgKGN1cnJlbnRIb3VyIDwgcmVhZFRpbWVSYW5nZVswXSkgb3IgKGN1cnJlbnRIb3VyID4gcmVhZFRpbWVSYW5nZVsxXSk6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV0g5qOA5rWL5Yiw5b2T5YmN5pe26Ze05LiN5Zyo6K6+5a6a55qE6ZiF6K+75pe26Ze06IyD5Zu0IHtyZWFkVGltZVJhbmdlWzBdfS17cmVhZFRpbWVSYW5nZVsxXX3lsI/ml7Yg5YaF77yM6Lez6L+H6ZiF6K+7IgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5yZWFkKCkKICAgICAgICAgICAgdGltZS5zbGVlcCgzKQogICAgICAgICAgICBzZWxmLmdvbGQoKQogICAgICAgICAgICB0aW1lLnNsZWVwKDMpCiAgICAgICAgICAgIHNlbGYud2l0aGRyYXcoKQoKCmRlZiBnZXROZXdJbnZpdGVVcmwoKToKICAgIHIgPSBzYWZlX3JlcXVlc3QoCiAgICAgICAgIkdFVCIsICJodHRwczovL3d3dy5maWxlc21lai5jbi93YWlkb21haW4ucGhwIiwgdmVyaWZ5PUZhbHNlCiAgICApLmpzb24oKQogICAgaWYgci5nZXQoImNvZGUiKSA9PSAwOgogICAgICAgIG5ld0VudHJ5VXJsID0gci5nZXQoImRhdGEiKS5nZXQoImx1b2RpIikKICAgICAgICBwYXJzZWRfdXJsID0gdXJscGFyc2UobmV3RW50cnlVcmwpCiAgICAgICAgaG9zdCA9IHBhcnNlZF91cmwuaG9zdG5hbWUKICAgICAgICByZXR1cm4gZiJodHRwOi8vdTdkcy5zeTY3My5zaG9wL3l1bm9ubGluZS92MS9hdXRoLzI2MzliYjk1ZGFiYTFkOTllNTMzOGE4YzJlMjFlMmYwP2NvZGV1cmw9dTdkcy5zeTY3My5zaG9wJmNvZGV1c2VyaWQ9MiZ0aW1lPTE3MDkwMjExNzYiLnJlcGxhY2UoCiAgICAgICAgICAgICJ1N2RzLnN5NjczLnNob3AiLCBob3N0IG9yICJ1N2RzLnN5NjczLnNob3AiCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICByZXR1cm4gImh0dHA6Ly91N2RzLnN5NjczLnNob3AveXVub25saW5lL3YxL2F1dGgvMjYzOWJiOTVkYWJhMWQ5OWU1MzM4YThjMmUyMWUyZjA/Y29kZXVybD11N2RzLnN5NjczLnNob3AmY29kZXVzZXJpZD0yJnRpbWU9MTcwOTAyMTE3NiIKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgIyBhcHBUb2tlbu+8mui/meS4quaYr+Whq3d4cHVzaGVy55qEYXBwVG9rZW4KICAgICMgdG9waWNJZHPvvJrov5nkuKrmmK93eHB1c2hlcueahHRvcGljSWRz5pS55oiQ5L2g6Ieq5bex55qECiAgICAjIOekuuS+izog5bm755SfI29aZEJwMDRwc2dvTjhkTjFFVF91bzgxTlRDMzEjMzAwMCNBVF9VeUlsYmoyMjIybnluRVNiTTJ2SnlBN0RybVVtVVhEIzExNjg2CiAgICBhY2NvdW50cyA9IG9zLmdldGVudigieHl5eWQiKQogICAgaW52aXRlVXJsID0gZ2V0TmV3SW52aXRlVXJsKCkKICAgIGlmIGFjY291bnRzIGlzIE5vbmU6CiAgICAgICAgcHJpbnQoZiLkvaDmsqHmnInloavlhaV4eXl5ZO+8jOWSi+i/kOihjO+8n1xu6LWw5LiL6YKA6K+35ZGX77yae2ludml0ZVVybH0iKQogICAgZWxzZToKICAgICAgICAjIOiOt+WPlueOr+Wig+WPmOmHj+eahOWAvO+8jOW5tuaMieaMh+WumuWtl+espuS4suWIhuWJsuaIkOWkmuS4qui0puWPt+eahOWPguaVsOe7hOWQiAogICAgICAgIGFjY291bnRzX2xpc3QgPSBvcy5lbnZpcm9uLmdldCgieHl5eWQiKS5zcGxpdCgiJiIpCgogICAgICAgICMg6L6T5Ye65pyJ5Yeg5Liq6LSm5Y+3CiAgICAgICAgbnVtX29mX2FjY291bnRzID0gbGVuKGFjY291bnRzX2xpc3QpCiAgICAgICAgbW9yZVRpcCA9ICIiCiAgICAgICAgaWYgcmVhZFBvc3REZWxheSA+IDA6CiAgICAgICAgICAgIG1vcmVUaXAgPSBmIuW3suiuvue9rueahOaOqOmAgeaWh+eroOetieW+heeCueWHu+aXtumXtOS4uiB7cmVhZFBvc3REZWxheX3np5IgIgogICAgICAgIHByaW50KAogICAgICAgICAgICBmIuW9k+WJjeiEmuacrOeJiOacrO+8muWwj+mYhemYhemYheivuyBWMS43MyBcbuW5u+eUn+aPkOekuu+8muiOt+WPluWIsCB7bnVtX29mX2FjY291bnRzfSDkuKrotKblj7cge21vcmVUaXB9XG7ms6jlhozlnLDlnYDvvJp7aW52aXRlVXJsfSIKICAgICAgICApCgogICAgICAgICMg6YGN5Y6G5omA5pyJ6LSm5Y+3CiAgICAgICAgZm9yIGksIGFjY291bnQgaW4gZW51bWVyYXRlKGFjY291bnRzX2xpc3QsIHN0YXJ0PTEpOgogICAgICAgICAgICAjIHByaW50KCJcbiIpCiAgICAgICAgICAgIHByaW50KCItIiAqIDUwKQogICAgICAgICAgICBwcmludChmIui0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV3lvIDlp4vmiafooYzku7vliqEgPj4+IikKICAgICAgICAgICAgIyBwcmludCgiXG4iKQogICAgICAgICAgICAjIOaMiUDnrKblj7fliIblibLlvZPliY3otKblj7fnmoTkuI3lkIzlj4LmlbAKICAgICAgICAgICAgdmFsdWVzID0gYWNjb3VudC5zcGxpdCgiIyIpCiAgICAgICAgICAgICMgcHJpbnQodmFsdWVzKQogICAgICAgICAgICBjZyA9IHt9CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGxlbih2YWx1ZXMpID09IDM6CiAgICAgICAgICAgICAgICAgICAgY2cgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogdmFsdWVzWzBdLAogICAgICAgICAgICAgICAgICAgICAgICAieXNtX3VpZCI6IHZhbHVlc1sxXSwKICAgICAgICAgICAgICAgICAgICAgICAgInVuaW9uSWQiOiB2YWx1ZXNbMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICJ0eGJ6IjogMzAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgImFsaUFjY291bnQiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgImFsaU5hbWUiOiAiIiwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGNnID0gewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6IHZhbHVlc1swXSwKICAgICAgICAgICAgICAgICAgICAgICAgInlzbV91aWQiOiB2YWx1ZXNbMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICJ1bmlvbklkIjogdmFsdWVzWzJdLAogICAgICAgICAgICAgICAgICAgICAgICAidHhieiI6IHZhbHVlc1szXSBvciAzMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAiYWxpQWNjb3VudCI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiYWxpTmFtZSI6ICIiLAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgIyDlpITnkIblvILluLgKICAgICAgICAgICAgICAgIHByaW50KCLlubvnlJ/pgLzpgLzlj6g6IiwgIumFjee9rueahOWVpeeOqeaEj++8jOe8uuWPguaVsOS6huaGqOaJue+8jOeci+a4heiEmuacrOivtOaYju+8gSIpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBjZ1siYXBwVG9rZW4iXSA9ICIiCiAgICAgICAgICAgIGNnWyJ0b3BpY0lkcyJdID0gIiIKICAgICAgICAgICAgIyBwcmludCgi5omL5Yqo77yaIiwgbGVuKHZhbHVlcyksIHZhbHVlc1s0XSkKICAgICAgICAgICAgaWYgbGVuKHZhbHVlcykgPj0gNToKICAgICAgICAgICAgICAgIGlmIHZhbHVlc1s0XToKICAgICAgICAgICAgICAgICAgICBjZ1siYXBwVG9rZW4iXSA9IHZhbHVlc1s0XQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY2dbImFwcFRva2VuIl0gPSB3eHB1c2hlckFwcFRva2VuCiAgICAgICAgICAgIGlmIGxlbih2YWx1ZXMpID49IDY6CiAgICAgICAgICAgICAgICBpZiB2YWx1ZXNbNV06CiAgICAgICAgICAgICAgICAgICAgY2dbInRvcGljSWRzIl0gPSB2YWx1ZXNbNV0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNnWyJ0b3BpY0lkcyJdID0gd3hwdXNoZXJUb3BpY0lkCiAgICAgICAgICAgIGlmIGxlbih2YWx1ZXMpID49IDc6CiAgICAgICAgICAgICAgICBpZiB2YWx1ZXNbNl06CiAgICAgICAgICAgICAgICAgICAgY2dbImFsaU5hbWUiXSA9IHZhbHVlc1s2XQogICAgICAgICAgICBpZiBsZW4odmFsdWVzKSA+PSA4OgogICAgICAgICAgICAgICAgaWYgdmFsdWVzWzddOgogICAgICAgICAgICAgICAgICAgIGNnWyJhbGlBY2NvdW50Il0gPSB2YWx1ZXNbN10KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgd2VjaGF0QnVzc2luZXNzS2V5ID09ICIiOgogICAgICAgICAgICAgICAgICAgIGlmIGNnWyJhcHBUb2tlbiJdLnN0YXJ0c3dpdGgoIkFUXyIpID09IEZhbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIuW5u+eUn+aPkOekuu+8jOi0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV0gd3hwdXNoIOmFjee9rumUmeivr++8jOW/q+S7lOe7hueci+WktOmDqOivtOaYju+8gSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgaWYgKGNnWyJhcHBUb2tlbiJdLnN0YXJ0c3dpdGgoIkFUXyIpID09IEZhbHNlKSBvciAoCiAgICAgICAgICAgICAgICAgICAgICAgIGNnWyJ0b3BpY0lkcyJdLmlzZGlnaXQoKSA9PSBGYWxzZQogICAgICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYi5bm755Sf5o+Q56S677yM6LSm5Y+3W3thY2NvdW50LnNwbGl0KCcjJylbMF19XSB3eHB1c2gg6YWN572u6ZSZ6K+v77yM5b+r5LuU57uG55yL5aS06YOo6K+05piO77yBIikKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGFwaSA9IEhIWUQoY2cpCiAgICAgICAgICAgICAgICBpZiBjZ1siYWxpTmFtZSJdIGFuZCBjZ1siYWxpQWNjb3VudCJdOgogICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICBmIuW5u+eUn+aPkOekuu+8jOi0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV0g6YeH55So5LqGIOaUr+S7mOWuneaPkOeOsO+8jOWnk+WQje+8mntjZ1snYWxpTmFtZSddfe+8jOi0puaIt++8mntjZ1snYWxpQWNjb3VudCddfSIKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYi5bm755Sf5o+Q56S677yM6LSm5Y+3W3thY2NvdW50LnNwbGl0KCcjJylbMF19XSDph4fnlKjkuoYg5b6u5L+h5o+Q546wIikKICAgICAgICAgICAgICAgIGFwaS5ydW4oKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBpZiAiRXhwZWN0aW5nIHZhbHVlOiBsaW5lIDEgY29sdW1uIDEiIGluIHN0cihlKToKICAgICAgICAgICAgICAgICAgICBwcmludChmIuW5u+eUn+aPkOekuu+8jOi0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV0g55aR5Ly8IHVuaW9uSWTlh7rplJnvvIzmjaLkuIDkuKrlkKfvvIEiKQogICAgICAgICAgICAgICAgZWxpZiAibGluaycgaXMgbm90IGRlZmluZWQiIGluIHN0cihlKToKICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgZiLlubvnlJ/mj5DnpLrvvIzotKblj7dbe2FjY291bnQuc3BsaXQoJyMnKVswXX1dIOeWkeS8vCDmlrDlj7fnmoTmn5Dnp43ljp/lm6Dlr7zoh7TnmoTml6Dms5XpmIXor7vvvIzor7fmiYvliqjpmIXor7vkuKTnr4flho3or5Xor5XlkKfvvIEiCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIuW5u+eUn+aPkOekuu+8jOi0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV0g5Ye66ZSZ5ZWm77yM6K+35bCG5LiL6Z2i5oql6ZSZ5oiq5Zu+5Y+R5YiwdGfkuqTmtYHnvqQ6IikKICAgICAgICAgICAgICAgIHJhaXNlIGUKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICMgcHJpbnQoIlxuIikKICAgICAgICAgICAgcHJpbnQoIi0iICogNTApCiAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3thY2NvdW50LnNwbGl0KCcjJylbMF19XeaJp+ihjOS7u+WKoeWujOavle+8gSIpCiAgICAgICAgICAgICMgcHJpbnQoIlxuIikK'))
except Exception as e:
    print('脚本执行出错:', str(e))
