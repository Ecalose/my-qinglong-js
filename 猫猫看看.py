# -*- coding: utf-8 -*-
#!/usr/bin/env python3
"""
* 仅供学习交流，请在下载后的24小时内完全删除 请勿将任何内容用于商业或非法目的，否则后果自负。
* 猫猫看看 V1.60

* 活动入口,微信打开：
* 如果连接过期了运行一下就出来了最新的入口！
* http://9pw4.dsdtew.shop/haobaobao/auth/58487f291985c5f32c16b3b01b96a912
* 打开活动入口，抓包的任意接口cookies中的Cookie参数
* 
* 变量格式：
* 新建同名环境变量
* 变量名：mykkyd
* 变量值：
* # 3000 代表 3毛，后面两个推送参数可不填，那就必须配置全局推送！
* 账号备注#Cookie参数#提现金额如3000#wxpushApptoken#wxpushTopicId
* 
* 其他参数说明（脚本最下方填写参数）
* wxpusher全局参数：wxpusherAppToken、wxpusherTopicId
* 具体使用方法请看文档地址：https://wxpusher.zjiecode.com/docs/#/
* 
* 也可使用 微信机器人：wechatBussinessKey
* 
* 支持支付宝提现：账号备注#Cookie参数#提现金额如3000#wxpushApptoken#wxpushTopicId#支付宝姓名#支付宝账号
* 只想提现支付宝，不想填写其他参数，最少的参数就是：账号备注#Cookie参数###支付宝姓名#支付宝账号
*
* 增加 自定义检测文章等待时间：mykkydReadPostDelay，默认值是 15-20秒
* 增加 精简日志：mykkydReadPureLog，默认值是 true（也就是精简日志，如果需要显示完整的，请设置为 false）
*
* 定时运行每半小时一次
* 达到标准，自动提现
"""
# This file requires Python 3.x and the following dependencies:
# - base64
try:
    import base64
    exec(base64.b64decode('IiIiCiog5LuF5L6b5a2m5Lmg5Lqk5rWB77yM6K+35Zyo5LiL6L295ZCO55qEMjTlsI/ml7blhoXlrozlhajliKDpmaQg6K+35Yu/5bCG5Lu75L2V5YaF5a6555So5LqO5ZWG5Lia5oiW6Z2e5rOV55uu55qE77yM5ZCm5YiZ5ZCO5p6c6Ieq6LSf44CCCiog54yr54yr55yL55yLIFYxLjYwCgoqIOa0u+WKqOWFpeWPoyzlvq7kv6HmiZPlvIDvvJoKKiDlpoLmnpzov57mjqXov4fmnJ/kuobov5DooYzkuIDkuIvlsLHlh7rmnaXkuobmnIDmlrDnmoTlhaXlj6PvvIEKKiBodHRwOi8vOXB3NC5kc2R0ZXcuc2hvcC9oYW9iYW9iYW8vYXV0aC81ODQ4N2YyOTE5ODVjNWYzMmMxNmIzYjAxYjk2YTkxMgoqIOaJk+W8gOa0u+WKqOWFpeWPo++8jOaKk+WMheeahOS7u+aEj+aOpeWPo2Nvb2tpZXPkuK3nmoRDb29raWXlj4LmlbAKKiAKKiDlj5jph4/moLzlvI/vvJoKKiDmlrDlu7rlkIzlkI3njq/looPlj5jph48KKiDlj5jph4/lkI3vvJpteWtreWQKKiDlj5jph4/lgLzvvJoKKiAjIDMwMDAg5Luj6KGoIDPmr5vvvIzlkI7pnaLkuKTkuKrmjqjpgIHlj4LmlbDlj6/kuI3loavvvIzpgqPlsLHlv4XpobvphY3nva7lhajlsYDmjqjpgIHvvIEKKiDotKblj7flpIfms6gjQ29va2ll5Y+C5pWwI+aPkOeOsOmHkemineWmgjMwMDAjd3hwdXNoQXBwdG9rZW4jd3hwdXNoVG9waWNJZAoqIAoqIOWFtuS7luWPguaVsOivtOaYju+8iOiEmuacrOacgOS4i+aWueWhq+WGmeWPguaVsO+8iQoqIHd4cHVzaGVy5YWo5bGA5Y+C5pWw77yad3hwdXNoZXJBcHBUb2tlbuOAgXd4cHVzaGVyVG9waWNJZAoqIOWFt+S9k+S9v+eUqOaWueazleivt+eci+aWh+aho+WcsOWdgO+8mmh0dHBzOi8vd3hwdXNoZXIuemppZWNvZGUuY29tL2RvY3MvIy8KKiAKKiDkuZ/lj6/kvb/nlKgg5b6u5L+h5py65Zmo5Lq677yad2VjaGF0QnVzc2luZXNzS2V5CiogCiog5pSv5oyB5pSv5LuY5a6d5o+Q546w77ya6LSm5Y+35aSH5rOoI0Nvb2tpZeWPguaVsCPmj5DnjrDph5Hpop3lpoIzMDAwI3d4cHVzaEFwcHRva2VuI3d4cHVzaFRvcGljSWQj5pSv5LuY5a6d5aeT5ZCNI+aUr+S7mOWunei0puWPtwoqIOWPquaDs+aPkOeOsOaUr+S7mOWune+8jOS4jeaDs+Whq+WGmeWFtuS7luWPguaVsO+8jOacgOWwkeeahOWPguaVsOWwseaYr++8mui0puWPt+Wkh+azqCNDb29raWXlj4LmlbAjIyPmlK/ku5jlrp3lp5PlkI0j5pSv5LuY5a6d6LSm5Y+3CioKKiDlop7liqAg6Ieq5a6a5LmJ5qOA5rWL5paH56ug562J5b6F5pe26Ze077yabXlra3lkUmVhZFBvc3REZWxhee+8jOm7mOiupOWAvOaYryAxNS0yMOenkgoqIOWinuWKoCDnsr7nroDml6Xlv5fvvJpteWtreWRSZWFkUHVyZUxvZ++8jOm7mOiupOWAvOaYryB0cnVl77yI5Lmf5bCx5piv57K+566A5pel5b+X77yM5aaC5p6c6ZyA6KaB5pi+56S65a6M5pW055qE77yM6K+36K6+572u5Li6IGZhbHNl77yJCioKKiDlrprml7bov5DooYzmr4/ljYrlsI/ml7bkuIDmrKEKKiDovr7liLDmoIflh4bvvIzoh6rliqjmj5DnjrAKIiIiCgppbXBvcnQgaGFzaGxpYgppbXBvcnQganNvbgppbXBvcnQgbWF0aAppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgdGltZQppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHJhbmRvbQppbXBvcnQgcmUKZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHF1b3RlLCB1cmxwYXJzZSwgcGFyc2VfcXMKaW1wb3J0IHVybGxpYjMKZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHBhcnNlX3FzLCB1cmxzcGxpdAppbXBvcnQgaGFzaGxpYgoKdXJsbGliMy5kaXNhYmxlX3dhcm5pbmdzKCkKCiMg5aGrd3hwdXNoZXLnmoRhcHBUb2tlbu+8jOmFjee9ruWcqOeOr+Wig+WPmOmHj+mHjOi/meagt+ayoemFjee9rueahOi0puWPt+S8muiHquWKqOS9v+eUqOi/meS4quaOqOmAgQp3eHB1c2hlckFwcFRva2VuID0gb3MuZ2V0ZW52KCJ3eHB1c2hlckFwcFRva2VuIikgb3IgIiIKd3hwdXNoZXJUb3BpY0lkID0gb3MuZ2V0ZW52KCJ3eHB1c2hlclRvcGljSWQiKSBvciAiIgp3ZWNoYXRCdXNzaW5lc3NLZXkgPSBvcy5nZXRlbnYoIndlY2hhdEJ1c3NpbmVzc0tleSIpIG9yICIiCm15a2t5ZERldGVjdGluZ1NlYWxTdGF0dXMgPSBUcnVlCm15a2t5ZERpc2FibGVkRGV0ZWN0aW5nU2VhbFNldHRpbmcgPSBvcy5nZXRlbnYoIm15a2t5ZERpc2FibGVkRGV0ZWN0aW5nU2VhbCIpCmlmIG15a2t5ZERpc2FibGVkRGV0ZWN0aW5nU2VhbFNldHRpbmcgbm90IGluIFsiIiwgTm9uZV06CiAgICBpZiBteWtreWREaXNhYmxlZERldGVjdGluZ1NlYWxTZXR0aW5nIGluIFsiMSIsICJ0cnVlIiwgVHJ1ZV06CiAgICAgICAgbXlra3lkRGV0ZWN0aW5nU2VhbFN0YXR1cyA9IEZhbHNlCnJlYWRQb3N0RGVsYXkgPSAwCmlmIG9zLmdldGVudigibXlra3lkUmVhZFBvc3REZWxheSIpIGFuZCBvcy5nZXRlbnYoIm15a2t5ZFJlYWRQb3N0RGVsYXkiKS5pc2RlY2ltYWwoKToKICAgIHJlYWRQb3N0RGVsYXkgPSBpbnQob3MuZ2V0ZW52KCJteWtreWRSZWFkUG9zdERlbGF5IikpCm15a2t5ZFJlYWRQdXJlTG9nID0gVHJ1ZQppZiBvcy5nZXRlbnYoIm15a2t5ZFJlYWRQdXJlTG9nIik6CiAgICBteWtreWRSZWFkUHVyZUxvZyA9IG9zLmdldGVudigibXlra3lkUmVhZFB1cmVMb2ciKSA9PSAidHJ1ZSIKIyDorr7nva7ku6PnkIblnLDlnYDlkoznq6/lj6MKcHJveGllcyA9IE5vbmUKaWYgb3MuZ2V0ZW52KCJteWtreWRIdHRwUHJveHlVcmwiKToKICAgIHByb3hpZXMgPSB7CiAgICAgICAgImh0dHAiOiBvcy5nZXRlbnYoIm15a2t5ZEh0dHBQcm94eVVybCIpLAogICAgICAgICJodHRwcyI6IG9zLmdldGVudigibXlra3lkSHR0cFByb3h5VXJsIiksCiAgICB9CgoKZGVmIGNoZWNrX2ZpbGVfbWQ1KHVybCwgZXhwZWN0ZWRfbWQ1KToKICAgICMg6I635Y+W5paH5Lu25YaF5a65CiAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICBkYXRhID0gcmVzcG9uc2UuY29udGVudAoKICAgICMg6K6h566XTUQ1CiAgICBtZDUgPSBoYXNobGliLm1kNSgpCiAgICBtZDUudXBkYXRlKGRhdGEpCiAgICBjYWxjdWxhdGVkX21kNSA9IG1kNS5oZXhkaWdlc3QoKQogICAgIyBwcmludCgi5b2T5YmN5paH5Lu255qETUQ15YC85Li677yaIiwgY2FsY3VsYXRlZF9tZDUpCiAgICAjIOavlOi+g01ENQogICAgcmV0dXJuIGNhbGN1bGF0ZWRfbWQ1ID09IGV4cGVjdGVkX21kNQoKCmRlZiBleHRyYWN0X21pZGRsZV90ZXh0KHNvdXJjZSwgYmVmb3JlX3RleHQsIGFmdGVyX3RleHQsIGFsbF9tYXRjaGVzPUZhbHNlKToKICAgIHJlc3VsdHMgPSBbXQogICAgc3RhcnRfaW5kZXggPSBzb3VyY2UuZmluZChiZWZvcmVfdGV4dCkKCiAgICB3aGlsZSBzdGFydF9pbmRleCAhPSAtMToKICAgICAgICBzb3VyY2VfYWZ0ZXJfYmVmb3JlX3RleHQgPSBzb3VyY2Vbc3RhcnRfaW5kZXggKyBsZW4oYmVmb3JlX3RleHQpIDpdCiAgICAgICAgZW5kX2luZGV4ID0gc291cmNlX2FmdGVyX2JlZm9yZV90ZXh0LmZpbmQoYWZ0ZXJfdGV4dCkKCiAgICAgICAgaWYgZW5kX2luZGV4ID09IC0xOgogICAgICAgICAgICBicmVhawoKICAgICAgICByZXN1bHRzLmFwcGVuZChzb3VyY2VfYWZ0ZXJfYmVmb3JlX3RleHRbOmVuZF9pbmRleF0pCiAgICAgICAgaWYgbm90IGFsbF9tYXRjaGVzOgogICAgICAgICAgICBicmVhawoKICAgICAgICBzb3VyY2UgPSBzb3VyY2VfYWZ0ZXJfYmVmb3JlX3RleHRbZW5kX2luZGV4ICsgbGVuKGFmdGVyX3RleHQpIDpdCiAgICAgICAgc3RhcnRfaW5kZXggPSBzb3VyY2UuZmluZChiZWZvcmVfdGV4dCkKCiAgICByZXR1cm4gcmVzdWx0cyBpZiBhbGxfbWF0Y2hlcyBlbHNlIHJlc3VsdHNbMF0gaWYgcmVzdWx0cyBlbHNlICIiCgoKZGVmIHB1c2goYXBwVG9rZW4sIHRvcGljSWRzLCB0aXRsZSwgbGluaywgdGV4dCwgdHlwZSk6CiAgICBkYXRhcHVzdCA9IHsKICAgICAgICAiYXBwVG9rZW4iOiBhcHBUb2tlbiwKICAgICAgICAiY29udGVudCI6IGYiIiI8Ym9keSBvbmxvYWQ9IndpbmRvdy5sb2NhdGlvbi5ocmVmPSd7bGlua30nIj7lh7rnjrDmo4DmtYvmlofnq6DvvIHvvIHvvIFcbjxhIHN0eWxlPSdwYWRkaW5nOjEwcHg7Y29sb3I6cmVkO2ZvbnQtc2l6ZToyMHB4OycgaHJlZj0ne2xpbmt9Jz7ngrnlh7vmiJHmiZPlvIDlvoXmo4DmtYvmlofnq6A8L2E+XG7or7flsL3lv6vngrnlh7vpk77mjqXlrozmiJDpmIXor7tcbuWkh+azqO+8mnt0ZXh0fTwvYm9keT4iIiIsCiAgICAgICAgInN1bW1hcnkiOiB0aXRsZSBvciAi54yr54yr55yL55yL6ZiF6K+7IiwKICAgICAgICAiY29udGVudFR5cGUiOiAyLAogICAgICAgICJ0b3BpY0lkcyI6IFt0b3BpY0lkcyBvciAiMTE2ODYiXSwKICAgICAgICAidXJsIjogbGluaywKICAgIH0KICAgICMgcHJpbnQoZGF0YXB1c3QpCiAgICB1cmxwdXN0ID0gImh0dHA6Ly93eHB1c2hlci56amllY29kZS5jb20vYXBpL3NlbmQvbWVzc2FnZSIKICAgIHRyeToKICAgICAgICBwID0gcmVxdWVzdHMucG9zdCh1cmw9dXJscHVzdCwganNvbj1kYXRhcHVzdCwgdmVyaWZ5PUZhbHNlKQogICAgICAgICMgcHJpbnQocCkKICAgICAgICBpZiBwLmpzb24oKVsiY29kZSJdID09IDEwMDA6CiAgICAgICAgICAgIHByaW50KCLinIUg5o6o6YCB5paH56ug5Yiw5b6u5L+h5oiQ5Yqf77yM6K+35bC95b+r5YmN5b6A54K55Ye75paH56ug77yM5LiN54S25bCx6buR5Y+35ZWm77yBIikKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgi4p2MIOaOqOmAgeaWh+eroOWIsOW+ruS/oeWksei0pe+8jOWujOeKiuWtkO+8jOimgem7keWPt+S6hu+8gSIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgZXhjZXB0OgogICAgICAgIHByaW50KCLinYwg5o6o6YCB5paH56ug5Yiw5b6u5L+h5aSx6LSl77yM5a6M54qK5a2Q77yM6KaB6buR5Y+35LqG77yBIikKICAgICAgICByZXR1cm4gRmFsc2UKCgpkZWYgcHVzaFdlY2hhdEJ1c3NpbmVzcyhyb2JvdEtleSwgbGluayk6CiAgICBkYXRhcHVzdCA9IHsibXNndHlwZSI6ICJ0ZXh0IiwgInRleHQiOiB7ImNvbnRlbnQiOiBsaW5rfX0KICAgICMgcHJpbnQoZGF0YXB1c3QpCiAgICB1cmxwdXN0ID0gImh0dHBzOi8vcXlhcGkud2VpeGluLnFxLmNvbS9jZ2ktYmluL3dlYmhvb2svc2VuZD9rZXk9IiArIHJvYm90S2V5CiAgICB0cnk6CiAgICAgICAgcCA9IHJlcXVlc3RzLnBvc3QodXJsPXVybHB1c3QsIGpzb249ZGF0YXB1c3QsIHZlcmlmeT1GYWxzZSkKICAgICAgICAjIHByaW50KHApCiAgICAgICAgaWYgcC5qc29uKClbImVycmNvZGUiXSA9PSAwOgogICAgICAgICAgICBwcmludCgi4pyFIOaOqOmAgeaWh+eroOWIsOS8geS4muW+ruS/oeaIkOWKn++8gSIpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoIuKdjCDmjqjpgIHmlofnq6DliLDkvIHkuJrlvq7kv6HlpLHotKXvvIEiKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgIGV4Y2VwdDoKICAgICAgICBwcmludCgi4p2MIOaOqOmAgeaWh+eroOWIsOS8geS4muW+ruS/oeWksei0pe+8gSIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgoKZGVmIGdldGluZm8obGluayk6CiAgICB0cnk6CiAgICAgICAgciA9IHJlcXVlc3RzLmdldChsaW5rLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgIyBwcmludChsaW5rLCByLnRleHQpCiAgICAgICAgaHRtbCA9IHJlLnN1YigiXHMiLCAiIiwgci50ZXh0KQogICAgICAgIGJpeiA9IHJlLmZpbmRhbGwoJ3ZhcmJpej0iKC4qPykiXHxcfCcsIGh0bWwpCiAgICAgICAgaWYgYml6ICE9IFtdOgogICAgICAgICAgICBiaXogPSBiaXpbMF0KICAgICAgICBpZiBiaXogPT0gIiIgb3IgYml6ID09IFtdOgogICAgICAgICAgICBpZiAiX19iaXoiIGluIGxpbms6CiAgICAgICAgICAgICAgICBiaXogPSByZS5maW5kYWxsKCJfX2Jpej0oLio/KSYiLCBsaW5rKQogICAgICAgICAgICAgICAgaWYgYml6ICE9IFtdOgogICAgICAgICAgICAgICAgICAgIGJpeiA9IGJpelswXQogICAgICAgIG5pY2tuYW1lID0gcmUuZmluZGFsbCgndmFybmlja25hbWU9aHRtbERlY29kZVwoIiguKj8pIlwpOycsIGh0bWwpCiAgICAgICAgaWYgbmlja25hbWUgIT0gW106CiAgICAgICAgICAgIG5pY2tuYW1lID0gbmlja25hbWVbMF0KICAgICAgICB1c2VyX25hbWUgPSByZS5maW5kYWxsKCd2YXJ1c2VyX25hbWU9IiguKj8pIjsnLCBodG1sKQogICAgICAgIGlmIHVzZXJfbmFtZSAhPSBbXToKICAgICAgICAgICAgdXNlcl9uYW1lID0gdXNlcl9uYW1lWzBdCiAgICAgICAgbXNnX3RpdGxlID0gcmUuZmluZGFsbCgidmFybXNnX3RpdGxlPScoLio/KSdcLmh0bWxcKCIsIGh0bWwpCiAgICAgICAgaWYgbXNnX3RpdGxlICE9IFtdOgogICAgICAgICAgICBtc2dfdGl0bGUgPSBtc2dfdGl0bGVbMF0KICAgICAgICB0ZXh0ID0gZiLlhazkvJflj7fllK/kuIDmoIfor4bvvJp7Yml6fXzmlofnq6A6e21zZ190aXRsZX185L2c6ICFOntuaWNrbmFtZX186LSm5Y+3Ont1c2VyX25hbWV9IgogICAgICAgIHByaW50KHRleHQpCiAgICAgICAgcmV0dXJuIG5pY2tuYW1lLCB1c2VyX25hbWUsIG1zZ190aXRsZSwgdGV4dCwgYml6CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgIyBwcmludChlKQogICAgICAgIHByaW50KCLinYwg5o+Q5Y+W5paH56ug5L+h5oGv5aSx6LSlIikKICAgICAgICByZXR1cm4gRmFsc2UKCgpkZWYgdHMoKToKICAgIHJldHVybiBzdHIoaW50KHRpbWUudGltZSgpKSkgKyAiMDAwIgoKCmNoZWNrRGljdCA9IHsKICAgICJNemt4TlRFM016UTRNUT09IjogWyLpppnlp5DniLHml4XooYwiLCAiZ2hfNTRhNjVkYzYwMDM5Il0sCiAgICAiTXpnNU1qTTBNREV3Tnc9PSI6IFsi5oiR5pys6Z2e5YehIiwgImdoXzQ2YjA3NjkwMzQ3MyJdLAogICAgIk16VXpPRFk0TnpFMk9RPT0iOiBbIuWkmuiCieiRoeiQhDIwMjAiLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXpreU1qRTNNell4TWc9PSI6IFsiWW91aGZ1bCIsICJnaF9iM2Q3OWNkMWUxYjUiXSwKICAgICJNemt4TmpNd05ESXpPQT09IjogWyLlsJHlubTmsqHmnInkuYzmiZjpgqYzIiwgImdoX2IzZDc5Y2QxZTFiNSJdLAogICAgIk16ZzNOelV4TWpjNU1nPT0iOiBbIuaYn+aYn+ivuuiogCIsICJnaF9iM2Q3OWNkMWUxYjUiXSwKICAgICJNemc0TlRjd09ERTFOQT09IjogWyLmlpHpqazov5jmsqHnnaExMjMiLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXprME9ESXhPREU0T1E9PSI6IFsi5oyB5a625aaZ5oub5a6d5YW4IiwgImdoX2IzZDc5Y2QxZTFiNSJdLAogICAgIk16ZzJOalV5TWpJMU5BPT0iOiBbIkxpbGlubmciLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXpJek1EY3pPRGc0TXc9PSI6IFsi5pyJ5pWF5LqL55qE5ZCM5a2mWSIsICJnaF9iM2Q3OWNkMWUxYjUiXSwKICAgICJNemc1T0RVeU16WXpNUT09IjogWyI3ODnkuZ/kuI3ooYwiLCAiZ2hfYjNkNzljZDFlMWI1Il0sCiAgICAiTXpVME56STVNamM0T1E9PSI6IFsi55qu6JuL55im6IKJ54yqIiwgImdoXzU4ZDdlZTU5M2I4NiJdLAogICAgIk16ZzVNRGd4T0RBek1nPT0iOiBbIuWMl+WMl+Wwj+WKqeaJiyIsICJnaF81OGQ3ZWU1OTNiODYiXSwKICAgICJNekl6TURjek9EZzRNdz09IjogWyLmnInmlYXkuovnmoTlkIzlraZZIiwgImdoX2I4YjkyOTM0ZGE1ZiJdLAogICAgIk16a3hORFUxTkRFek53PT0iOiBbIueMq+eMq+eci+eci+acjeWKoSIsICJnaF9lNTBjZmVmZWY5ZTUiXSwKfQoKCmNsYXNzIEhIWUQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY2cpOgogICAgICAgIHNlbGYuQ29va2llID0gY2dbIkNvb2tpZSJdCiAgICAgICAgc2VsZi50eGJ6ID0gY2dbInR4YnoiXQogICAgICAgIHNlbGYudG9waWNJZHMgPSBjZ1sidG9waWNJZHMiXQogICAgICAgIHNlbGYuYXBwVG9rZW4gPSBjZ1siYXBwVG9rZW4iXQogICAgICAgIGdsb2JhbCB3ZWNoYXRCdXNzaW5lc3NLZXkKICAgICAgICBzZWxmLndlY2hhdEJ1c3NpbmVzc0tleSA9IHdlY2hhdEJ1c3NpbmVzc0tleSBvciAiIgogICAgICAgIHNlbGYuYWxpQWNjb3VudCA9IGNnWyJhbGlBY2NvdW50Il0gb3IgIiIKICAgICAgICBzZWxmLmFsaU5hbWUgPSBjZ1siYWxpTmFtZSJdIG9yICIiCiAgICAgICAgc2VsZi5uYW1lID0gY2dbIm5hbWUiXQogICAgICAgIHNlbGYuZG9tbmFpbkhvc3QgPSAiMTY5ODg1NTEzOS5oeGlvbmcudG9wIgogICAgICAgIHNlbGYucmVxdWVzdF9pZCA9ICIiCiAgICAgICAgc2VsZi5oZWFkZXJzID0gewogICAgICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQsICovKjsgcT0wLjAxIiwKICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA2MjEpIFhXRUIvODM1MSBGbHVlIiwKICAgICAgICAgICAgIlgtUmVxdWVzdGVkLVdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiLAogICAgICAgICAgICAiUmVmZXJlciI6IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fS8iLAogICAgICAgICAgICAiT3JpZ2luIjogZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9IiwKICAgICAgICAgICAgIyAiSG9zdCI6IGYie3NlbGYuZG9tbmFpbkhvc3R9IiwKICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ6aC1DTix6aCIsCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKICAgICAgICAgICAgIkNvb2tpZSI6IHNlbGYuQ29va2llLAogICAgICAgIH0KICAgICAgICBzZWxmLnNlYyA9IHJlcXVlc3RzLnNlc3Npb24oKQogICAgICAgIHNlbGYuc2VjLnZlcmlmeSA9IEZhbHNlCiAgICAgICAgc2VsZi5zZWMuaGVhZGVycyA9IHNlbGYuaGVhZGVycwogICAgICAgIHNlbGYubGFzdGJpeiA9ICIiCiAgICAgICAgc2VsZi5yZWFkSnVtcFBhdGggPSAiIgogICAgICAgIHNlbGYucmV0cnlSZWFkaW5nID0gRmFsc2UKCiAgICBkZWYgdXNlcl9pbmZvKHNlbGYpOgogICAgICAgIHUgPSBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0vaGFvYmFvYmFvL3VzZXIiCiAgICAgICAgciA9ICIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICByID0gc2VsZi5zZWMuZ2V0KHUpCiAgICAgICAgICAgIHJqID0gci5qc29uKCkKICAgICAgICAgICAgaWYgcmouZ2V0KCJlcnJjb2RlIikgPT0gMDoKICAgICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeiOt+WPluS/oeaBr+aIkOWKn++8jOeUqOaIt0lE5Li6IHtyLmpzb24oKVsnZGF0YSddWyd1c2VyaWQnXX0iKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeiOt+WPlueUqOaIt+S/oeaBr+Wksei0pe+8jOi0puWPt+W8guW4uCDmiJbogIUgQ29va2ll5peg5pWI77yM6K+35qOA5rWLQ29va2ll5piv5ZCm5q2j56GuIikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoci50ZXh0KQogICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV3ojrflj5bnlKjmiLfkv6Hmga/lpLHotKUsQ29va2ll5peg5pWI77yM6K+35qOA5rWLQ29va2ll5piv5ZCm5q2j56GuIikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIGdvbGQoc2VsZik6CiAgICAgICAgciA9ICIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICB1ID0gZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9L2hhb2Jhb2Jhby93b3JraW5mbyIKICAgICAgICAgICAgciA9IHNlbGYuc2VjLmdldCh1KQogICAgICAgICAgICAjIHByaW50KHIuanNvbigpKQogICAgICAgICAgICByaiA9IHIuanNvbigpCiAgICAgICAgICAgIHNlbGYucmVtYWluX2dvbGQgPSBtYXRoLmZsb29yKGludChyai5nZXQoImRhdGEiKS5nZXQoInJlbWFpbl9nb2xkIikpKQogICAgICAgICAgICBzZWxmLnJlbWFpbiA9IGZsb2F0KHJqLmdldCgiZGF0YSIpLmdldCgicmVtYWluIikpCiAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgZifku4rml6Xlt7Lnu4/pmIXor7vkuoZ7cmouZ2V0KCJkYXRhIikuZ2V0KCJkYXlyZWFkcyIpfeevh+aWh+eroCDlvZPliY3ph5HluIF7cmouZ2V0KCJkYXRhIikuZ2V0KCJyZW1haW5fZ29sZCIpfSDlvZPliY3kvZnpop17c2VsZi5yZW1haW59JwogICAgICAgICAgICApCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV3ojrflj5bph5HluIHlpLHotKUiKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgZ2V0S2V5KHNlbGYpOgogICAgICAgIHVrID0gIiIKICAgICAgICB1a1JlcyA9IE5vbmUKICAgICAgICBmb3IgaSBpbiByYW5nZSgxMCk6CiAgICAgICAgICAgIHUgPSBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH17c2VsZi5yZWFkSnVtcFBhdGh9IgogICAgICAgICAgICAjIHByaW50KCLmj5DnpLogZ2V0S2V577yaIiwgdSkKICAgICAgICAgICAgcCA9IGYiIgogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1LCBoZWFkZXJzPXNlbGYuaGVhZGVycywgZGF0YT1wLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgICAgICMgcHJpbnQoImdldEtlee+8miIsIHIudGV4dCkKICAgICAgICAgICAgcmogPSByLmpzb24oKQogICAgICAgICAgICBkb21haW4gPSByai5nZXQoImRhdGEiKS5nZXQoImRvbWFpbiIpCiAgICAgICAgICAgICMgcHJpbnQoIuivt+axguS4rei9rOmhte+8miIsIHIudGV4dCkKICAgICAgICAgICAgcHAgPSBwYXJzZV9xcyh1cmxwYXJzZShkb21haW4pLnF1ZXJ5KQogICAgICAgICAgICBobiA9IHVybHBhcnNlKGRvbWFpbikubmV0bG9jCiAgICAgICAgICAgIHVrID0gcHAuZ2V0KCJ1ayIpWzBdCiAgICAgICAgICAgIHVrUmVzID0gci50ZXh0CiAgICAgICAgICAgIGlmIHVrOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICBpZiB1ayA9PSAiIjoKICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d6I635Y+WdWvlpLHotKXvvIzov5Tlm57plJnor6/vvJp7dWtSZXN9IikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgdGltZS5zbGVlcCg4KQogICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoCiAgICAgICAgICAgIGRvbWFpbiwKICAgICAgICAgICAgaGVhZGVycz17CiAgICAgICAgICAgICAgICAiQWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuOSIsCiAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUsIGJyIiwKICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiemgtQ04semg7cT0wLjkiLAogICAgICAgICAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgICAgICAgICAiSG9zdCI6IGYie2hufSIsCiAgICAgICAgICAgICAgICAiU2VjLUZldGNoLURlc3QiOiAiZG9jdW1lbnQiLAogICAgICAgICAgICAgICAgIlNlYy1GZXRjaC1Nb2RlIjogIm5hdmlnYXRlIiwKICAgICAgICAgICAgICAgICJTZWMtRmV0Y2gtU2l0ZSI6ICJub25lIiwKICAgICAgICAgICAgICAgICJTZWMtRmV0Y2gtVXNlciI6ICI/MSIsCiAgICAgICAgICAgICAgICAiVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0cyI6ICIxIiwKICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMDcuMC4wLjAgU2FmYXJpLzUzNy4zNiBOZXRUeXBlL1dJRkkgTWljcm9NZXNzZW5nZXIvNy4wLjIwLjE3ODEoMHg2NzAwMTQzQikgV2luZG93c1dlY2hhdCgweDYzMDkwNzFkKSBYV0VCLzg0NjEgRmx1ZSIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHZlcmlmeT1GYWxzZSwKICAgICAgICApCiAgICAgICAgIyA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9pbWFnZS5oenlzbXl5LmNuL3l1bnNhb21hL25ld3Byb2plY3QvanMvYXJ0aWNsZS5qcz92NC4wIj48L3NjcmlwdD4KICAgICAgICByZWFkSnNWZXJzaW9uID0gZXh0cmFjdF9taWRkbGVfdGV4dChyLnRleHQsICJqcy9hcnRpY2xlLmpzPyIsICciJykKICAgICAgICBjaGVja0pzQ29kZUNoYW5nZWQgPSAoCiAgICAgICAgICAgIGNoZWNrX2ZpbGVfbWQ1KAogICAgICAgICAgICAgICAgZXh0cmFjdF9taWRkbGVfdGV4dChyLnRleHQsICc8c2NyaXB0IHNyYz0iJywgJyI+PC9zY3JpcCcpLAogICAgICAgICAgICAgICAgImQwMzMyZGVhNTIxMzNjZWRhZGRiNDdhY2U0Y2FlNTZkIiwKICAgICAgICAgICAgKQogICAgICAgICAgICA9PSBGYWxzZQogICAgICAgICkKICAgICAgICBpZiAocmVhZEpzVmVyc2lvbiAhPSAidjcuMCIpIG9yIGNoZWNrSnNDb2RlQ2hhbmdlZDoKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV0g5qOA5rWL5Yiw5o6l5Y+j54mI5pys5Y+R55Sf5Y+Y5YyW77yM5b2T5YmN5o6l5Y+j54mI5pys5Li677yae3JlYWRKc1ZlcnNpb25977yM5ouJ5ZON6K2m5oql77yM5Y+w5a2Q5pCe5LqL77yM6KaB5oqT5Lq65LqG77yM5byA5aeL5pKk6YCA77yM6YCA5Ye656iL5bqPID4+ICIKICAgICAgICAgICAgKQogICAgICAgICAgICBzeXMuZXhpdCgwKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOmYheivu+WHhuWkh+WujOaIkO+8mnt1a33vvIzmj5Dlj5bliLDnmoTlnLDlnYDvvJp7ZG9tYWlufSIpCiAgICAgICAgICAgIGlmIG15a2t5ZFJlYWRQdXJlTG9nID09IEZhbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiLotKblj7dbe3NlbGYubmFtZX1dIOmYheivu+WHhuWkh+aIkOWKn++8jOW9k+WJjeaOpeWPo+eJiOacrOS4uu+8mntyZWFkSnNWZXJzaW9ufSDljbPlsIblvIDlp4vpmIXor7sg4pyFIO+8jOmYheivu+WPguaVsOS4uu+8mnt1a30iCiAgICAgICAgICAgICAgICApCiAgICAgICAgaCA9IHsKICAgICAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQsICovKjsgcT0wLjAxIiwKICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlLCBiciIsCiAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiemgtQ04semg7cT0wLjkiLAogICAgICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAgICAgIkhvc3QiOiBobiwKICAgICAgICAgICAgIk9yaWdpbiI6IGYiaHR0cHM6Ly97aG59IiwKICAgICAgICAgICAgIlNlYy1GZXRjaC1EZXN0IjogImVtcHR5IiwKICAgICAgICAgICAgIlNlYy1GZXRjaC1Nb2RlIjogImNvcnMiLAogICAgICAgICAgICAiU2VjLUZldGNoLVNpdGUiOiAiY3Jvc3Mtc2l0ZSIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMDcuMC4wLjAgU2FmYXJpLzUzNy4zNiBOZXRUeXBlL1dJRkkgTWljcm9NZXNzZW5nZXIvNy4wLjIwLjE3ODEoMHg2NzAwMTQzQikgV2luZG93c1dlY2hhdCgweDYzMDkwNzFkKSBYV0VCLzg0NjEgRmx1ZSIsCiAgICAgICAgfQogICAgICAgIHJldHVybiB1aywgaAoKICAgIGRlZiByZWFkKHNlbGYpOgogICAgICAgIGluZm8gPSBzZWxmLmdldEtleSgpCiAgICAgICAgaWYgbGVuKGluZm8pID09IDA6CiAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeiOt+WPlumYheivu+WPguaVsOWksei0pe+8jOWBnOatouW+gOWQjumYheivu++8geKaoO+4jyAiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAjIHByaW50KGluZm8pCiAgICAgICAgdGltZS5zbGVlcCgyKQogICAgICAgIGFyY3RpbGVUaW1lID0gMQogICAgICAgIHNlbGYucmV0cnlSZWFkaW5nID0gRmFsc2UKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICByZXMgPSB7ImVycmNvZGUiOiAtMX0KICAgICAgICAgICAgIyByYXdSZXMgPSAiIgogICAgICAgICAgICByZWZyZXNoVGltZSA9IDAKICAgICAgICAgICAgd2hpbGUgcmVzWyJlcnJjb2RlIl0gIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYucmV0cnlSZWFkaW5nID0gRmFsc2UKICAgICAgICAgICAgICAgIHRpbWVTdGFtcCA9IHN0cih0cygpKQogICAgICAgICAgICAgICAgbXlzaWduID0gaGFzaGxpYi5tZDUoCiAgICAgICAgICAgICAgICAgICAgKGluZm9bMV1bIkhvc3QiXSArIHRpbWVTdGFtcCArICJMaio/UTMjcE92aVciKS5lbmNvZGUoKQogICAgICAgICAgICAgICAgKS5oZXhkaWdlc3QoKQogICAgICAgICAgICAgICAgc2VsZi5wYXJhbXMgPSB7CiAgICAgICAgICAgICAgICAgICAgInVrIjogaW5mb1swXSwKICAgICAgICAgICAgICAgICAgICAidGltZSI6IHRpbWVTdGFtcCwKICAgICAgICAgICAgICAgICAgICAibXlzaWduIjogbXlzaWduLAogICAgICAgICAgICAgICAgICAgICJ2IjogIjUuMCIsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB1ID0gZiJodHRwczovL25zci56c2YyMDIzZTQ1OC5jbG91ZC9oYW9iYW9iYW8vbWt3ZW56aGFuZ3MiCiAgICAgICAgICAgICAgICAjIHByaW50KAogICAgICAgICAgICAgICAgIyAgICAgIumYheivu+aWh+eroOWPguaVsOafpeeci++8miIsCiAgICAgICAgICAgICAgICAjICAgICB1LAogICAgICAgICAgICAgICAgIyAgICAgc2VsZi5wYXJhbXMsCiAgICAgICAgICAgICAgICAjICAgICBpbmZvLAogICAgICAgICAgICAgICAgIyAgICAgaW5mb1sxXVsiT3JpZ2luIl0ucmVwbGFjZSgiaHR0cHM6Ly8iLCAiIikucmVwbGFjZSgiLyIsICIiKSwKICAgICAgICAgICAgICAgICMgKQogICAgICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCgKICAgICAgICAgICAgICAgICAgICB1LAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9aW5mb1sxXSwKICAgICAgICAgICAgICAgICAgICBwYXJhbXM9c2VsZi5wYXJhbXMsCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ9NjAsCiAgICAgICAgICAgICAgICAgICAgcHJveGllcz1wcm94aWVzLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgcHJpbnQoIi0iICogNTApCiAgICAgICAgICAgICAgICAjIGlmIG15a2t5ZFJlYWRQdXJlTG9nID09IEZhbHNlOgogICAgICAgICAgICAgICAgIyAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAjICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeesrFt7cmVmcmVzaFRpbWUrMX1d5qyh6I635Y+W6ZiF6K+75paH56ugW3tpbmZvWzBdfV3nm67nmoTpobXvvJp7ci50ZXh0fSIKICAgICAgICAgICAgICAgICMgKQogICAgICAgICAgICAgICAgIyByYXdSZXMgPSByLnRleHQKICAgICAgICAgICAgICAgICMgcHJpbnQoIuiOt+WPluaWh+eroOmYheivu+mTvuaOpe+8miIsIHUsIGluZm9bMV0sIHIudGV4dCkKICAgICAgICAgICAgICAgIGlmIHIudGV4dCBhbmQgci5qc29uKClbImVycmNvZGUiXSA9PSAwOgogICAgICAgICAgICAgICAgICAgIHJlcyA9IHIuanNvbigpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeesrFt7cmVmcmVzaFRpbWUrMX1d5qyh6I635Y+W56ysW3thcmN0aWxlVGltZX1d56+H6ZiF6K+75paH56ugW3tpbmZvWzBdfV3ot7Povazpk77mjqXmiJDlip8iCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBkZWNvZGVkX3N0ciA9IGpzb24ubG9hZHMoci50ZXh0KQogICAgICAgICAgICAgICAgICAgIGlmIGRlY29kZWRfc3RyWyJtc2ciXToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV3nrKxbe3JlZnJlc2hUaW1lKzF9XeasoeiOt+WPluesrFt7YXJjdGlsZVRpbWV9Xeevh+mYheivu+aWh+eroFt7aW5mb1swXX1d6Lez6L2s6ZO+5o6l5aSx6LSl77yae2RlY29kZWRfc3RyWydtc2cnXX0iCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV3nrKxbe3JlZnJlc2hUaW1lKzF9XeasoeiOt+WPluesrFt7YXJjdGlsZVRpbWV9Xeevh+mYheivu+aWh+eroFt7aW5mb1swXX1d6Lez6L2s6ZO+5o6l5aSx6LSl77yae3IudGV4dH0iCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMS41KQogICAgICAgICAgICAgICAgcmVmcmVzaFRpbWUgPSByZWZyZXNoVGltZSArIDEKICAgICAgICAgICAgICAgIGlmIHJlZnJlc2hUaW1lID49IDU6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLimqDvuI8g6LSm5Y+3W3tzZWxmLm5hbWV9XeiOt+WPlumYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1d6LaF5pe24oCm4oCmIikKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgd2VjaGF0UG9zdExpbmsgPSAiIgogICAgICAgICAgICBpZiByZXMuZ2V0KCJlcnJjb2RlIikgPT0gMDoKICAgICAgICAgICAgICAgIHJldHVybkxpbmsgPSAiIgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHJldHVybkxpbmsgPSByZXMuZ2V0KCJkYXRhIikuZ2V0KCJsaW5rIikKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBlcnJvck1zZyA9IHJlcy5nZXQoImRhdGEiKQogICAgICAgICAgICAgICAgICAgICMgcHJpbnQoIjHmiqXplJnvvJoiLCBlKQogICAgICAgICAgICAgICAgICAgICMgcHJpbnQoIjHov5Tlm57vvJoiLCByYXdSZXMpCiAgICAgICAgICAgICAgICAgICAgaWYgIjQwNCBOb3QgRm91bmQiIGluIGVycm9yTXNnOgogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1zZyA9ICLlj7DlrZDmjqXlj6PkuI3ooYzvvIzltKnkuoZ+IgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJldHJ5UmVhZGluZyA9IFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIuKaoO+4jyDotKblj7dbe3NlbGYubmFtZX1d6I635Y+W6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3pk77mjqXlpLHotKXvvIznlpHkvLzlj7DlrZDmjqXlj6PlpKrlnoPlnL7vvIzltKnkuobvvIzov5Tlm57mlbDmja7kuLrvvJoiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2csCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgZiLimqDvuI8g6LSm5Y+3W3tzZWxmLm5hbWV9XeiOt+WPlumYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1d6ZO+5o6l5aSx6LSl77yM55aR5Ly85Y+w5a2Q5o6l5Y+j5aSq5Z6D5Zy+77yM5bSp5LqG77yM6L+U5Zue5pWw5o2u5Li677yaIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2csCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBpZiAibXAud2VpeGluLnFxLmNvbSIgaW4gcmV0dXJuTGluazoKICAgICAgICAgICAgICAgICAgICBpZiBteWtreWRSZWFkUHVyZUxvZyA9PSBGYWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOmYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+W+ruS/oeaWh+eroO+8mntyZXR1cm5MaW5rfSIpCiAgICAgICAgICAgICAgICAgICAgd2VjaGF0UG9zdExpbmsgPSByZXR1cm5MaW5rCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOmYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroOWHhuWkh+i3s+i9rO+8mntsaW5rfSIpCiAgICAgICAgICAgICAgICAgICAgd2VjaGF0UG9zdExpbmsgPSBzZWxmLmp1bXAocmV0dXJuTGluaykKICAgICAgICAgICAgICAgICAgICBpZiBteWtreWRSZWFkUHVyZUxvZyA9PSBGYWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5b6u5L+h5paH56ug77yae3dlY2hhdFBvc3RMaW5rfSIKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaWYgbXlra3lkUmVhZFB1cmVMb2cgPT0gRmFsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOmYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroO+8mnt3ZWNoYXRQb3N0TGlua30iKQogICAgICAgICAgICAgICAgcG9zdEluZm8gPSBnZXRpbmZvKHdlY2hhdFBvc3RMaW5rKQogICAgICAgICAgICAgICAgaWYgcG9zdEluZm8gPT0gRmFsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV3lm6Ag6I635Y+W5YWs5LyX5Y+35paH56ug5L+h5oGv5LiN5oiQ5Yqf77yM5a+86Ie06ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV0g5aSx6LSl4oCm4oCmIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIHNsZWVwVGltZSA9IHJhbmRvbS5yYW5kaW50KDcsIDEwKQogICAgICAgICAgICAgICAgIyDlpoLmnpzmmK/mo4DmtYvnibnlvoHliLDnmoTmlofnq6Ag5oiW6ICFIOWQjuS4gOevh+aWh+eroOS4juWJjeS4gOevh+ebuOS8vAogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIGNoZWNrRGljdC5nZXQocG9zdEluZm9bNF0pICE9IE5vbmUKICAgICAgICAgICAgICAgICAgICBvciAocmVzLmdldCgiZGF0YSIpLmdldCgiYSIpID09IDIpCiAgICAgICAgICAgICAgICAgICAgb3IgKCImY2hrc209IiBpbiB3ZWNoYXRQb3N0TGluaykKICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgc2xlZXBUaW1lID0gcmVhZFBvc3REZWxheSBvciByYW5kb20ucmFuZGludCgxNSwgMjApCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV3pmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XSDmo4DmtYvliLDnlpHkvLzmo4DmtYvmlofnq6DvvIzmraPlnKjmjqjpgIHvvIznrYnlvoXov4fmo4DmtYvvvIznrYnlvoXml7bpl7TvvJp7c2xlZXBUaW1lfeenkuOAguOAguOAgiIKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi53ZWNoYXRCdXNzaW5lc3NLZXk6CiAgICAgICAgICAgICAgICAgICAgICAgIHB1c2hXZWNoYXRCdXNzaW5lc3Moc2VsZi53ZWNoYXRCdXNzaW5lc3NLZXksIHdlY2hhdFBvc3RMaW5rKQogICAgICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5hcHBUb2tlbjoKICAgICAgICAgICAgICAgICAgICAgICAgcHVzaCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXBwVG9rZW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRvcGljSWRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIueMq+eMq+eci+eci+mYheivu+i/h+ajgOa1iyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ZWNoYXRQb3N0TGluaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XemYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1dIOato+WcqOetieW+hei/h+ajgOa1i++8jOetieW+heaXtumXtO+8mntzbGVlcFRpbWV956eSXG7lubvnlJ/mj5DnpLrvvJrlv6vngrnvvIzliKvogL3mkIHml7bpl7TkuobvvIEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm15a2t5ZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV3pmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XSDpnIDopoHov4fmo4DmtYvvvIzkvYbmmK/mnKrphY3nva7mjqjpgIF0b2tlbu+8jOS4uuS6humBv+WFjem7keWPt++8jOWBnOatoumYheivu+OAguOAguOAgiIKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4pyFIOi0puWPt1t7c2VsZi5uYW1lfV3pmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XSDpnZ7mo4DmtYvmlofnq6DvvIzmqKHmi5/or7t7c2xlZXBUaW1lfeenkiIKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBzZWxmLmxhc3RiaXogPSBwb3N0SW5mb1s0XQogICAgICAgICAgICAgICAgdGltZS5zbGVlcChzbGVlcFRpbWUpCiAgICAgICAgICAgICAgICB1MSA9IGYiaHR0cHM6Ly9uc3IuenNmMjAyM2U0NTguY2xvdWQvaGFvYmFvYmFvL2FkZGdvbGRzMj90aW1lPXtzbGVlcFRpbWV9JnVrPXtpbmZvWzBdfSZwc2lnbj17bXlzaWdufSIKICAgICAgICAgICAgICAgIHIxID0gcmVxdWVzdHMuZ2V0KHUxLCBoZWFkZXJzPWluZm9bMV0sIHZlcmlmeT1GYWxzZSkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAjIHByaW50KCLlop7liqDph5HluIHvvJoiLCB1MSwgaW5mb1sxXSwgcjEudGV4dCkKICAgICAgICAgICAgICAgICAgICBpZiByMS50ZXh0IGFuZCByMS5qc29uKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi4pyFIOi0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3miYDlvpfph5HluIHvvJp7cjEuanNvbigpWydkYXRhJ11bJ2dvbGQnXX3kuKrvvIzotKbmiLflvZPliY3ph5HluIHvvJp7cjEuanNvbigpWydkYXRhJ11bJ2xhc3RfZ29sZCddfeS4qu+8jOS7iuaXpeW3suivu++8mntyMS5qc29uKClbJ2RhdGEnXVsnZGF5X3JlYWQnXX3mrKHvvIzku4rml6XmnKror7sge3IxLmpzb24oKVsnZGF0YSddWydyZW1haW5fcmVhZCddfeevh+aWh+eroCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiLinYwg6LSm5Y+3W3tzZWxmLm5hbWV9XSDpmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XeW8guW4uO+8mntyMS5qc29uKCkuZ2V0KCdtc2cnKX0iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAi5pys5qyh6ZiF6K+75peg5pWIIiBpbiByMS5qc29uKCkuZ2V0KCJtc2ciKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiLinYwg6LSm5Y+3W3tzZWxmLm5hbWV9XSDpmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XeWksei0pe+8mntyMS50ZXh0fSIKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICMgcHJpbnQoIjLmiqXplJnvvJoiLCBlKQogICAgICAgICAgICAgICAgICAgICMgcHJpbnQoIjLov5Tlm57vvJoiLCByMS50ZXh0KQogICAgICAgICAgICAgICAgICAgIGVycm9yTXNnID0gcjEudGV4dAogICAgICAgICAgICAgICAgICAgIGlmICI0MDQgTm90IEZvdW5kIiBpbiBlcnJvck1zZzoKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2cgPSAi5Y+w5a2Q5o6l5Y+j5LiN6KGM77yM5bSp5LqGfiIKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZXRyeVJlYWRpbmcgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiLimqDvuI8g6LSm5Y+3W3tzZWxmLm5hbWV9XSDpmIXor7vnrKxbe2FyY3RpbGVUaW1lfV3nr4fmlofnq6Bbe2luZm9bMF19XeW8guW4uO+8jOi/lOWbnuaVsOaNruS4uu+8miIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1zZywKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICBmIuKaoO+4jyDotKblj7dbe3NlbGYubmFtZX1dIOmYheivu+esrFt7YXJjdGlsZVRpbWV9Xeevh+aWh+eroFt7aW5mb1swXX1d5byC5bi477yM6L+U5Zue5pWw5o2u5Li677yaIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2csCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVsaWYgcmVzLmdldCgiZXJyY29kZSIpID09IDQwNToKICAgICAgICAgICAgICAgIHByaW50KGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3pmIXor7vph43lpI0iKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxLjUpCiAgICAgICAgICAgIGVsaWYgcmVzLmdldCgiZXJyY29kZSIpID09IDQwNzoKICAgICAgICAgICAgICAgIHByaW50KGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3pmIXor7vnu5PmnZ8iKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KGYi4pqg77iPIOi0puWPt1t7c2VsZi5uYW1lfV0g6ZiF6K+756ysW3thcmN0aWxlVGltZX1d56+H5paH56ugW3tpbmZvWzBdfV3mnKrnn6Xmg4XlhrUiKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxLjUpCiAgICAgICAgICAgIGFyY3RpbGVUaW1lID0gYXJjdGlsZVRpbWUgKyAxCgogICAgZGVmIGp1bXAoc2VsZiwgbGluayk6CiAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d5byA5aeL5pys5qyh6ZiF6K+74oCm4oCmIikKICAgICAgICBobiA9IHVybHBhcnNlKGxpbmspLm5ldGxvYwogICAgICAgIGggPSB7CiAgICAgICAgICAgICJIb3N0IjogaG4sCiAgICAgICAgICAgICJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogICAgICAgICAgICAiVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0cyI6ICIxIiwKICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA2MjEpIFhXRUIvODM1MSBGbHVlIiwKICAgICAgICAgICAgIkFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLAogICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoIiwKICAgICAgICAgICAgIkNvb2tpZSI6IHNlbGYuQ29va2llLAogICAgICAgIH0KICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGxpbmssIGhlYWRlcnM9aCwgYWxsb3dfcmVkaXJlY3RzPUZhbHNlLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgIyBwcmludChyLnN0YXR1c19jb2RlKQogICAgICAgIExvY2F0aW9uID0gci5oZWFkZXJzLmdldCgiTG9jYXRpb24iKQogICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeW8gOWni+mYheivu+aWh+eroCAtIHtMb2NhdGlvbn0iKQogICAgICAgIHJldHVybiBMb2NhdGlvbgoKICAgIGRlZiB3aXRoZHJhd1Bvc3Qoc2VsZik6CiAgICAgICAgdSA9IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fS9oYW9iYW9iYW8vZ2V0d2l0aGRyYXciCiAgICAgICAgcCA9IGYic2lnbmlkPXtzZWxmLnJlcXVlc3RfaWR9JnVhPTAmcHR5cGU9MCZwYWNjb3VudD0mcG5hbWU9IgogICAgICAgIGlmIHNlbGYuYWxpQWNjb3VudCBhbmQgc2VsZi5hbGlOYW1lOgogICAgICAgICAgICBwID0gZiJzaWduaWQ9e3NlbGYucmVxdWVzdF9pZH0mdWE9MiZwdHlwZT0xJnBhY2NvdW50PXtxdW90ZShzZWxmLmFsaUFjY291bnQpfSZwbmFtZT17cXVvdGUoc2VsZi5hbGlOYW1lKX0iCiAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QoCiAgICAgICAgICAgIHUsCiAgICAgICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQsICovKjsgcT0wLjAxIiwKICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoO3E9MC45IiwKICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKICAgICAgICAgICAgICAgICJDb29raWUiOiBzZWxmLkNvb2tpZSwKICAgICAgICAgICAgICAgICJIb3N0IjogZiJ7c2VsZi5kb21uYWluSG9zdH0iLAogICAgICAgICAgICAgICAgIk9yaWdpbiI6IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fSIsCiAgICAgICAgICAgICAgICAiUHJveHktQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAgICAgICAgICJSZWZlcmVyIjogZiJodHRwOi8ve3NlbGYuZG9tbmFpbkhvc3R9L2hhb2Jhb2Jhby93aXRoZHJhdyIsCiAgICAgICAgICAgICAgICAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhdGE9cCwKICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICkKICAgICAgICBwcmludChmIuKchSDotKblj7dbe3NlbGYubmFtZX1dIOaPkOeOsOe7k+aenO+8miIsIHIuanNvbigpWyJtc2ciXSkKCiAgICBkZWYgd2l0aGRyYXcoc2VsZik6CiAgICAgICAgZ29sZCA9IGludChpbnQoc2VsZi5yZW1haW5fZ29sZCkgLyAxMDAwKSAqIDEwMDAKICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV0g5pys5qyh5o+Q546w6YeR6aKdICIsIHNlbGYucmVtYWluLCAi5YWDICIsIGdvbGQsICLph5HluIEiKQogICAgICAgIHdpdGhkcmF3QmFsYW5jZSA9IHJvdW5kKChpbnQoc2VsZi50eGJ6KSAvIDEwMDAwKSwgMykKICAgICAgICBpZiBnb2xkIG9yIChzZWxmLnJlbWFpbiA+PSB3aXRoZHJhd0JhbGFuY2UpOgogICAgICAgICAgICBpZiBnb2xkIGFuZCAoKGZsb2F0KHNlbGYucmVtYWluKSArIGdvbGQgLyAxMDAwMCkgPD0gMzApOgogICAgICAgICAgICAgICAgIyDlvIDlp4vmj5DnjrAKICAgICAgICAgICAgICAgICMg5Lul5LiL6YC76L6R5rKh55So77yM5LiN566h5L2gZ29sZOS4uuWkmuWwke+8jOWug+mDveaYr+WFqOmDqOWFkeaNogogICAgICAgICAgICAgICAgIyBtYXhDYW5FeGNoYW5nZUdvbGQgPSAoMjkuOSAtIHNlbGYucmVtYWluKSAqIDEwMDAwCiAgICAgICAgICAgICAgICAjIGlmIG1heENhbkV4Y2hhbmdlR29sZCA+IDA6CiAgICAgICAgICAgICAgICAjICAgICBnb2xkID0gbWluKG1heENhbkV4Y2hhbmdlR29sZCwgZ29sZCkKICAgICAgICAgICAgICAgICMgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDkuLrpgb/lhY3otoXov4fkuInljYHlnZfvvIzmnKzmrKHlhZHmjaLph5HluIHmlbDkuLogIiwgZ29sZCwgIumHkeW4gSIpCiAgICAgICAgICAgICAgICB1MSA9IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fS9oYW9iYW9iYW8vZ2V0Z29sZCIKICAgICAgICAgICAgICAgIHAxID0gZiJyZXF1ZXN0X2lkPXtzZWxmLnJlcXVlc3RfaWR9JmdvbGQ9e2dvbGR9IgogICAgICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QoCiAgICAgICAgICAgICAgICAgICAgdTEsCiAgICAgICAgICAgICAgICAgICAgZGF0YT1wMSwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPXsKICAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQsICovKjsgcT0wLjAxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ6aC1DTix6aDtxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKICAgICAgICAgICAgICAgICAgICAgICAgIkNvb2tpZSI6IHNlbGYuQ29va2llLAogICAgICAgICAgICAgICAgICAgICAgICAiSG9zdCI6IGYie3NlbGYuZG9tbmFpbkhvc3R9IiwKICAgICAgICAgICAgICAgICAgICAgICAgIk9yaWdpbiI6IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJQcm94eS1Db25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogICAgICAgICAgICAgICAgICAgICAgICAiUmVmZXJlciI6IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fS9oYW9iYW9iYW8vd2l0aGRyYXciLAogICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTA3LjAuMC4wIFNhZmFyaS81MzcuMzYgTmV0VHlwZS9XSUZJIE1pY3JvTWVzc2VuZ2VyLzcuMC4yMC4xNzgxKDB4NjcwMDE0M0IpIFdpbmRvd3NXZWNoYXQoMHg2MzA5MDcxZCkgWFdFQi84NDYxIEZsdWUiLAogICAgICAgICAgICAgICAgICAgICAgICAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB2ZXJpZnk9RmFsc2UsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgcmVzID0gci5qc29uKCkKICAgICAgICAgICAgICAgICAgICBpZiByZXMuZ2V0KCJlcnJjb2RlIikgPT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aGRyYXdCYWxhbmNlTnVtID0gc2VsZi5yZW1haW4gKyBmbG9hdChyZXNbImRhdGEiXVsibW9uZXkiXSkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIuKchSDotKblj7dbe3NlbGYubmFtZX1dIOmHkeW4geWFkeaNouS4uueOsOmHkeaIkOWKn++8jOW8gOWni+aPkOeOsO+8jOmihOiuoeWIsOi0piB7d2l0aGRyYXdCYWxhbmNlTnVtfSDlhYMgPj4+ICIKICAgICAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgd2l0aGRyYXdCYWxhbmNlTnVtIDwgd2l0aGRyYXdCYWxhbmNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d5rKh5pyJ6L6+5Yiw5o+Q546w5qCH5YeGIHt3aXRoZHJhd0JhbGFuY2V9IOWFgyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi53aXRoZHJhd1Bvc3QoKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDph5HluIHlhZHmjaLkuLrnjrDph5HlpLHotKXvvJoiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgci50ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiDmj5DnjrDlnLDlnYDvvJoiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIOaPkOeOsOWPguaVsO+8miIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMSwKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICMgcmFpc2UgZQogICAgICAgICAgICAgICAgICAgICMg5aSE55CG5byC5bi4CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOaPkOeOsOWksei0pe+8miIsIGUpCiAgICAgICAgICAgIHNlbGYud2l0aGRyYXdQb3N0KCkKCiAgICBkZWYgaW5pdChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoCiAgICAgICAgICAgICAgICBnZXROZXdJbnZpdGVVcmwoKSwKICAgICAgICAgICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAgICAgICAgICJVcGdyYWRlLUluc2VjdXJlLVJlcXVlc3RzIjogIjEiLAogICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMDcuMC4wLjAgU2FmYXJpLzUzNy4zNiBOZXRUeXBlL1dJRkkgTWljcm9NZXNzZW5nZXIvNy4wLjIwLjE3ODEoMHg2NzAwMTQzQikgV2luZG93c1dlY2hhdCgweDYzMDkwNzFkKSBYV0VCLzg0NjEgRmx1ZSIsCiAgICAgICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLAogICAgICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ6aC1DTix6aDtxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgIkNvb2tpZSI6IHNlbGYuQ29va2llLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHZlcmlmeT1GYWxzZSwKICAgICAgICAgICAgICAgICMg56aB5q2i6YeN5a6a5ZCRCiAgICAgICAgICAgICAgICBhbGxvd19yZWRpcmVjdHM9RmFsc2UsCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5kb21uYWluSG9zdCA9IHIuaGVhZGVycy5nZXQoIkxvY2F0aW9uIikuc3BsaXQoIi8iKVsyXQogICAgICAgICAgICAjIHByaW50KHIudGV4dCkKICAgICAgICAgICAgaWYgbXlra3lkUmVhZFB1cmVMb2cgPT0gRmFsc2U6CiAgICAgICAgICAgICAgICBwcmludChmIui0puWPt1t7c2VsZi5uYW1lfV3mj5Dlj5bliLDnmoTln5/lkI3vvJp7c2VsZi5kb21uYWluSG9zdH0iKQogICAgICAgICAgICAjIHNlbGYuaGVhZGVycyA9IHsKICAgICAgICAgICAgIyAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgICAgICMgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMSIsCiAgICAgICAgICAgICMgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMDcuMC4wLjAgU2FmYXJpLzUzNy4zNiBOZXRUeXBlL1dJRkkgTWljcm9NZXNzZW5nZXIvNy4wLjIwLjE3ODEoMHg2NzAwMTQzQikgV2luZG93c1dlY2hhdCgweDYzMDkwNjIxKSBYV0VCLzgzNTEgRmx1ZSIsCiAgICAgICAgICAgICMgICAgICJYLVJlcXVlc3RlZC1XaXRoIjogIlhNTEh0dHBSZXF1ZXN0IiwKICAgICAgICAgICAgIyAgICAgIlJlZmVyZXIiOiBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0vIiwKICAgICAgICAgICAgIyAgICAgIk9yaWdpbiI6IGYiaHR0cDovL3tzZWxmLmRvbW5haW5Ib3N0fSIsCiAgICAgICAgICAgICMgICAgICMgIkhvc3QiOiBmIntzZWxmLmRvbW5haW5Ib3N0fSIsCiAgICAgICAgICAgICMgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICMgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiemgtQ04semgiLAogICAgICAgICAgICAjICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsCiAgICAgICAgICAgICMgICAgICJDb29raWUiOiBzZWxmLkNvb2tpZSwKICAgICAgICAgICAgIyB9CiAgICAgICAgICAgICMgIyDojrflj5ZyZXF1ZXN0SWQKICAgICAgICAgICAgc2VsZi5yZWFkSnVtcFBhdGggPSAiIgogICAgICAgICAgICBpZiBteWtreWREZXRlY3RpbmdTZWFsU3RhdHVzOgogICAgICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCgKICAgICAgICAgICAgICAgICAgICBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0vaGFvYmFvYmFvL2hvbWUiLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAgICAgICAgICAgICAiVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0cyI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA3MWQpIFhXRUIvODQ2MSBGbHVlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLAogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoO3E9MC45IiwKICAgICAgICAgICAgICAgICAgICAgICAgIkNvb2tpZSI6IHNlbGYuQ29va2llLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaHRtbHRleHQgPSByLnRleHQKICAgICAgICAgICAgICAgIHJlYWRfanVtcF9yZWFkX3RleHQgPSBleHRyYWN0X21pZGRsZV90ZXh0KAogICAgICAgICAgICAgICAgICAgIGh0bWx0ZXh0LCAiZnVuY3Rpb24gcmVhZF9qdW1wX3JlYWQoKXsiLCAic3VjY2VzczogZnVuY3Rpb24iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBpZiByZWFkX2p1bXBfcmVhZF90ZXh0OgogICAgICAgICAgICAgICAgICAgIHJlYWRKdW1wUGF0aCA9IGV4dHJhY3RfbWlkZGxlX3RleHQoCiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRfanVtcF9yZWFkX3RleHQsICJ1cmw6IGRvbWFpbisnIiwgIicsIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBpZiByZWFkSnVtcFBhdGg6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucmVhZEp1bXBQYXRoID0gcmVhZEp1bXBQYXRoCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIui0puWPt1t7c2VsZi5uYW1lfV0g5Yid5aeL5YyW5aSx6LSl77yM6K+35omL5Yqo6K6/6Zeu5LiL56Gu6K6k6aG16Z2i5rKh5bSp5rqDIOaIluiAhSDnqI3lkI7lho3or5XlkKfvvIzkuIDnm7TkuI3ooYzvvIzor7fliY3lvoBUR+e+pOWPjemmiH4gIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiAi5a2Y5Zyo6L+d6KeE5pON5L2cIiBpbiBodG1sdGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOiiq+ajgOa1i+WIsOS6hu+8jOW3sue7j+iiq+Wwge+8jOe7iOatouS7u+WKoe+8jOW/q+WOu+aPkOmGkuWkp+WutuWQp34gIikKICAgICAgICAgICAgICAgICAgICAgICAgc3lzLmV4aXQoMCkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDliJ3lp4vljJblpLHotKXvvIzor7fmiYvliqjorr/pl67kuIvnoa7orqTpobXpnaLmsqHltKnmuoMg5oiW6ICFIOeojeWQjuWGjeivleWQp++8jOS4gOebtOS4jeihjO+8jOivt+WJjeW+gFRH576k5Y+N6aaIfiAiCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnJlYWRKdW1wUGF0aCA9ICIvaGFvYmFvYmFvL3d0bXBkb21haW4yIgogICAgICAgICAgICAjICMg6I635Y+W5o+Q546w6aG16Z2i5Zyw5Z2ACiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoCiAgICAgICAgICAgICAgICBmImh0dHA6Ly97c2VsZi5kb21uYWluSG9zdH0vaGFvYmFvYmFvL3dpdGhkcmF3IiwKICAgICAgICAgICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAgICAgICAgICJVcGdyYWRlLUluc2VjdXJlLVJlcXVlc3RzIjogIjEiLAogICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMDcuMC4wLjAgU2FmYXJpLzUzNy4zNiBOZXRUeXBlL1dJRkkgTWljcm9NZXNzZW5nZXIvNy4wLjIwLjE3ODEoMHg2NzAwMTQzQikgV2luZG93c1dlY2hhdCgweDYzMDkwNzFkKSBYV0VCLzg0NjEgRmx1ZSIsCiAgICAgICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLAogICAgICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ6aC1DTix6aDtxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgIkNvb2tpZSI6IHNlbGYuQ29va2llLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHZlcmlmeT1GYWxzZSwKICAgICAgICAgICAgKQogICAgICAgICAgICBodG1sdGV4dCA9IHIudGV4dAogICAgICAgICAgICBzaWduaWRsID0gcmUuc2VhcmNoKCdyZXF1ZXN0X2lkID0gIiguKj8pIicsIGh0bWx0ZXh0KQogICAgICAgICAgICBpZiBzaWduaWRsID09IFtdOgogICAgICAgICAgICAgICAgaWYgbXlra3lkUmVhZFB1cmVMb2cgPT0gRmFsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1d5Yid5aeL5YyWIOaPkOeOsOWPguaVsCDlpLHotKXvvIzlsJ3or5Xlj6bkuIDnp43liJ3lp4vljJYgPj4+ICIpCiAgICAgICAgICAgICAgICByID0gcmVxdWVzdHMuZ2V0KAogICAgICAgICAgICAgICAgICAgIGYiaHR0cHM6Ly9jb2RlLnN5d2ptbG91LmNvbS5jbi9iYW9iYW9jb2RlLnBocCIsCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZG9tbmFpbkhvc3QgPSByLmpzb24oKVsiZGF0YSJdWyJsdW9kaSJdLnNwbGl0KCIvIilbMl0KICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoCiAgICAgICAgICAgICAgICAgICAgZiJodHRwOi8ve2RvbW5haW5Ib3N0fS9oYW9iYW9iYW8vd2l0aGRyYXciLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAgICAgICAgICAgICAiVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0cyI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwNy4wLjAuMCBTYWZhcmkvNTM3LjM2IE5ldFR5cGUvV0lGSSBNaWNyb01lc3Nlbmdlci83LjAuMjAuMTc4MSgweDY3MDAxNDNCKSBXaW5kb3dzV2VjaGF0KDB4NjMwOTA3MWQpIFhXRUIvODQ2MSBGbHVlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjkiLAogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInpoLUNOLHpoO3E9MC45IiwKICAgICAgICAgICAgICAgICAgICAgICAgIkNvb2tpZSI6IHNlbGYuQ29va2llLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PUZhbHNlLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaHRtbHRleHQgPSByLnRleHQKICAgICAgICAgICAgICAgIHNpZ25pZGwgPSByZS5zZWFyY2goJ3JlcXVlc3RfaWQgPSAiKC4qPykiJywgaHRtbHRleHQpCiAgICAgICAgICAgICAgICBpZiBzaWduaWRsID09IFtdOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XSDlpJrmrKHliJ3lp4vljJYg5o+Q546w5Y+C5pWwIOWksei0pSwg6LSm5Y+35byC5bi477yM6K+35qOA5p+lQ29va2ll77yBIikKICAgICAgICAgICAgICAgICAgICByID0gcmVxdWVzdHMuZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICBmImh0dHBzOi8vY29kZS5zeXdqbWxvdS5jb20uY24vYmFvYmFvY29kZS5waHAiLAogICAgICAgICAgICAgICAgICAgICAgICB2ZXJpZnk9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGYuZG9tbmFpbkhvc3QgPSByLmpzb24oKVsiZGF0YSJdWyJsdW9kaSJdLnNwbGl0KCIvIilbMl0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0X2lkID0gc2lnbmlkbFsxXQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0X2lkID0gc2lnbmlkbFsxXQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgIyByYWlzZSBlCiAgICAgICAgICAgIHByaW50KGYi6LSm5Y+3W3tzZWxmLm5hbWV9XeWIneWni+WMluWksei0pSzor7fmo4Dmn6XkvaDnmoRjayIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgaWYgc2VsZi5pbml0KCk6CiAgICAgICAgICAgIHNlbGYudXNlcl9pbmZvKCkKICAgICAgICAgICAgc2VsZi5nb2xkKCkKICAgICAgICAgICAgaWYgIuebtOaOpeaPkCIgbm90IGluIHNlbGYubmFtZToKICAgICAgICAgICAgICAgIHNlbGYucmVhZCgpCiAgICAgICAgICAgICAgICAjIOWmguaenOaOpeWPo+W0qeS6hu+8jOWwseWwneivleS4ieasoemHjeWQr+mYheivuwogICAgICAgICAgICAgICAgaWYgc2VsZi5yZXRyeVJlYWRpbmcgPT0gVHJ1ZToKICAgICAgICAgICAgICAgICAgICBpZiBteWtreWRSZWFkUHVyZUxvZyA9PSBGYWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe3NlbGYubmFtZX1dIOajgOa1i+WIsOmYheivu+aOpeWPo+W8guW4uO+8jOWwneivlemHjeivlX4iKQogICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDMpOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlYWQoKQogICAgICAgICAgICAgICAgICAgICAgICAjIOmaj+acuuW7tui/nwogICAgICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKHJhbmRvbS5yYW5kb20oKSAqIDMgKyAxKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLnJldHJ5UmVhZGluZyA9PSBGYWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDMpCiAgICAgICAgICAgICAgICBzZWxmLmdvbGQoKQogICAgICAgICAgICB0aW1lLnNsZWVwKDMpCiAgICAgICAgICAgIHNlbGYud2l0aGRyYXcoKQoKCmRlZiBnZXROZXdJbnZpdGVVcmwoKToKICAgIHIgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vY29kZS5zeXdqbWxvdS5jb20uY24vYmFvYmFvY29kZS5waHAiLCB2ZXJpZnk9RmFsc2UpLmpzb24oKQogICAgaWYgci5nZXQoImNvZGUiKSA9PSAwOgogICAgICAgIG5ld0VudHJ5VXJsID0gci5nZXQoImRhdGEiKS5nZXQoImx1b2RpIikKICAgICAgICBwYXJzZWRfdXJsID0gdXJscGFyc2UobmV3RW50cnlVcmwpCiAgICAgICAgaG9zdCA9IHBhcnNlZF91cmwuaG9zdG5hbWUKICAgICAgICByZXR1cm4gZiJodHRwOi8vczFpNi4xb2JnLnNob3AvaGFvYmFvYmFvL2F1dGgvNTg0ODdmMjkxOTg1YzVmMzJjMTZiM2IwMWI5NmE5MTIiLnJlcGxhY2UoCiAgICAgICAgICAgICJzMWk2LjFvYmcuc2hvcCIsIGhvc3Qgb3IgInMxaTYuMW9iZy5zaG9wIgogICAgICAgICkKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuICJodHRwOi8vczFpNi4xb2JnLnNob3AvaGFvYmFvYmFvL2F1dGgvNTg0ODdmMjkxOTg1YzVmMzJjMTZiM2IwMWI5NmE5MTIiCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgICMgYXBwVG9rZW7vvJrov5nkuKrmmK/loat3eHB1c2hlcueahGFwcFRva2VuCiAgICAjIHRvcGljSWRz77ya6L+Z5Liq5pivd3hwdXNoZXLnmoR0b3BpY0lkc+aUueaIkOS9oOiHquW3seeahAogICAgIyDnpLrkvos6IOW5u+eUnyNvWmRCcDA0cHNnb044ZE4xRVRfdW84MU5UQzMxIzMwMDAjQVRfVXlJbGJqMjIyMm55bkVTYk0ydkp5QTdEcm1VbVVYRCMxMTY4NgogICAgYWNjb3VudHMgPSBvcy5nZXRlbnYoIm15a2t5ZCIpCiAgICBpbnZpdGVVcmwgPSBnZXROZXdJbnZpdGVVcmwoKQogICAgaWYgYWNjb3VudHMgaXMgTm9uZToKICAgICAgICBwcmludChmIuS9oOayoeacieWhq+WFpW15a2t5ZO+8jOWSi+i/kOihjO+8n1xu6LWw5LiL6YKA6K+35ZGX77yae2ludml0ZVVybH0iKQogICAgZWxzZToKICAgICAgICAjIOiOt+WPlueOr+Wig+WPmOmHj+eahOWAvO+8jOW5tuaMieaMh+WumuWtl+espuS4suWIhuWJsuaIkOWkmuS4qui0puWPt+eahOWPguaVsOe7hOWQiAogICAgICAgIGFjY291bnRzX2xpc3QgPSBvcy5lbnZpcm9uLmdldCgibXlra3lkIikuc3BsaXQoIiYiKQoKICAgICAgICAjIOi+k+WHuuacieWHoOS4qui0puWPtwogICAgICAgIG51bV9vZl9hY2NvdW50cyA9IGxlbihhY2NvdW50c19saXN0KQogICAgICAgIG1vcmVUaXAgPSAiIgogICAgICAgIGlmIHJlYWRQb3N0RGVsYXkgPiAwOgogICAgICAgICAgICBtb3JlVGlwID0gZiLlt7Lorr7nva7nmoTmjqjpgIHmlofnq6DnrYnlvoXngrnlh7vml7bpl7TkuLoge3JlYWRQb3N0RGVsYXl956eSICIKICAgICAgICBwcmludCgKICAgICAgICAgICAgZiLlvZPliY3ohJrmnKzniYjmnKzvvJrlubvnlJ/prZTmlLnoh6rnlKjniYggVjEuNjAgXG7lubvnlJ/mj5DnpLrvvJrojrflj5bliLAge251bV9vZl9hY2NvdW50c30g5Liq6LSm5Y+3IHttb3JlVGlwfVxu5rOo5YaM5Zyw5Z2A77yae2ludml0ZVVybH0iCiAgICAgICAgKQoKICAgICAgICAjIOmBjeWOhuaJgOaciei0puWPtwogICAgICAgIGZvciBpLCBhY2NvdW50IGluIGVudW1lcmF0ZShhY2NvdW50c19saXN0LCBzdGFydD0xKToKICAgICAgICAgICAgIyBwcmludCgiXG4iKQogICAgICAgICAgICBwcmludCgiLSIgKiA1MCkKICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe2FjY291bnQuc3BsaXQoJyMnKVswXX1d5byA5aeL5omn6KGM5Lu75YqhID4+PiIpCiAgICAgICAgICAgICMgcHJpbnQoIlxuIikKICAgICAgICAgICAgIyDmjIlA56ym5Y+35YiG5Ymy5b2T5YmN6LSm5Y+355qE5LiN5ZCM5Y+C5pWwCiAgICAgICAgICAgIHZhbHVlcyA9IGFjY291bnQuc3BsaXQoIiMiKQogICAgICAgICAgICAjIHByaW50KHZhbHVlcykKICAgICAgICAgICAgY2cgPSB7fQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBsZW4odmFsdWVzKSA9PSAyOgogICAgICAgICAgICAgICAgICAgIGNnID0gewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6IHZhbHVlc1swXSwKICAgICAgICAgICAgICAgICAgICAgICAgIkNvb2tpZSI6IHZhbHVlc1sxXSwKICAgICAgICAgICAgICAgICAgICAgICAgInR4YnoiOiAzMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAiYWxpQWNjb3VudCI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiYWxpTmFtZSI6ICIiLAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgY2cgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogdmFsdWVzWzBdLAogICAgICAgICAgICAgICAgICAgICAgICAiQ29va2llIjogdmFsdWVzWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAidHhieiI6IHZhbHVlc1syXSBvciAzMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAiYWxpQWNjb3VudCI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiYWxpTmFtZSI6ICIiLAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgIyDlpITnkIblvILluLgKICAgICAgICAgICAgICAgIHByaW50KCLlubvnlJ/pgLzpgLzlj6g6IiwgIumFjee9rueahOWVpeeOqeaEj++8jOe8uuWPguaVsOS6huaGqOaJue+8jOeci+a4heiEmuacrOivtOaYju+8gSIpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBjZ1siYXBwVG9rZW4iXSA9ICIiCiAgICAgICAgICAgIGNnWyJ0b3BpY0lkcyJdID0gIiIKICAgICAgICAgICAgIyBwcmludCgi5omL5Yqo77yaIiwgbGVuKHZhbHVlcyksIHZhbHVlc1s0XSkKICAgICAgICAgICAgaWYgbGVuKHZhbHVlcykgPj0gNDoKICAgICAgICAgICAgICAgIGlmIHZhbHVlc1szXToKICAgICAgICAgICAgICAgICAgICBjZ1siYXBwVG9rZW4iXSA9IHZhbHVlc1szXQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY2dbImFwcFRva2VuIl0gPSB3eHB1c2hlckFwcFRva2VuCiAgICAgICAgICAgIGlmIGxlbih2YWx1ZXMpID49IDU6CiAgICAgICAgICAgICAgICBpZiB2YWx1ZXNbNF06CiAgICAgICAgICAgICAgICAgICAgY2dbInRvcGljSWRzIl0gPSB2YWx1ZXNbNF0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNnWyJ0b3BpY0lkcyJdID0gd3hwdXNoZXJUb3BpY0lkCiAgICAgICAgICAgIGlmIGxlbih2YWx1ZXMpID49IDY6CiAgICAgICAgICAgICAgICBpZiB2YWx1ZXNbNV06CiAgICAgICAgICAgICAgICAgICAgY2dbImFsaU5hbWUiXSA9IHZhbHVlc1s1XQogICAgICAgICAgICBpZiBsZW4odmFsdWVzKSA+PSA3OgogICAgICAgICAgICAgICAgaWYgdmFsdWVzWzZdOgogICAgICAgICAgICAgICAgICAgIGNnWyJhbGlBY2NvdW50Il0gPSB2YWx1ZXNbNl0KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgd2VjaGF0QnVzc2luZXNzS2V5ID09ICIiOgogICAgICAgICAgICAgICAgICAgIGlmIGNnWyJhcHBUb2tlbiJdLnN0YXJ0c3dpdGgoIkFUXyIpID09IEZhbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIuW5u+eUn+aPkOekuu+8jOi0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV0gd3hwdXNoIOmFjee9rumUmeivr++8jOW/q+S7lOe7hueci+WktOmDqOivtOaYju+8gSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgaWYgKGNnWyJhcHBUb2tlbiJdLnN0YXJ0c3dpdGgoIkFUXyIpID09IEZhbHNlKSBvciAoCiAgICAgICAgICAgICAgICAgICAgICAgIGNnWyJ0b3BpY0lkcyJdLmlzZGlnaXQoKSA9PSBGYWxzZQogICAgICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYi5bm755Sf5o+Q56S677yM6LSm5Y+3W3thY2NvdW50LnNwbGl0KCcjJylbMF19XSB3eHB1c2gg6YWN572u6ZSZ6K+v77yM5b+r5LuU57uG55yL5aS06YOo6K+05piO77yBIikKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGFwaSA9IEhIWUQoY2cpCiAgICAgICAgICAgICAgICBpZiBjZ1siYWxpTmFtZSJdIGFuZCBjZ1siYWxpQWNjb3VudCJdOgogICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICBmIuW5u+eUn+aPkOekuu+8jOi0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV0g6YeH55So5LqGIOaUr+S7mOWuneaPkOeOsO+8jOWnk+WQje+8mntjZ1snYWxpTmFtZSddfe+8jOi0puaIt++8mntjZ1snYWxpQWNjb3VudCddfSIKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYi5bm755Sf5o+Q56S677yM6LSm5Y+3W3thY2NvdW50LnNwbGl0KCcjJylbMF19XSDph4fnlKjkuoYg5b6u5L+h5o+Q546wIikKICAgICAgICAgICAgICAgIGFwaS5ydW4oKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIuW5u+eUn+aPkOekuu+8jOi0puWPt1t7YWNjb3VudC5zcGxpdCgnIycpWzBdfV0g5Ye66ZSZ5ZWm77yM5Lmf6K645piv5bmz5Y+w5o6l5Y+j6Zeu6aKY77yM5Y+v5Lul6L+H5LiA5Lya5bCd6K+V6YeN5paw6L+Q6KGM77yM5aaC5p6c6L+Y5piv5LiN6KGM77yM6K+35bCG5LiL6Z2i5oql6ZSZ5oiq5Zu+5Y+R5YiwdGfkuqTmtYHnvqQ6IgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgcmFpc2UgZQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgIyBwcmludCgiXG4iKQogICAgICAgICAgICBwcmludCgiLSIgKiA1MCkKICAgICAgICAgICAgcHJpbnQoZiLotKblj7dbe2FjY291bnQuc3BsaXQoJyMnKVswXX1d5omn6KGM5Lu75Yqh5a6M5q+V77yBIikKICAgICAgICAgICAgIyBwcmludCgiXG4iKQo='))
except Exception as e:
    print('脚本执行出错:', str(e))
